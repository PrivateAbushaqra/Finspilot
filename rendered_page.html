

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تحرير فاتورة المبيعات - نظام إدارة الأعمال</title>
    
    <!-- Bootstrap CSS -->
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Favicon -->
    
    <link rel="shortcut icon" type="image/png" href="/static/FinsPiloticn.png">
    
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="/static/core/css/responsive.css">
    <link rel="stylesheet" href="/static/core/css/table-responsive.css">
    
    <!-- Session Management CSS -->
    
    <link rel="stylesheet" href="/static/core/css/session-management.css">
    
    
    <!-- Session settings for JavaScript -->
    
        
        
        <meta name="session-timeout" content="30">
        <meta name="session-timeout-enabled" content="true">
        <meta name="logout-on-browser-close" content="false">
    
    
    <style>
        :root {
            /* fallbacks kept intentionally; values overridden if superadmin_settings provided */
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --accent-color: #28a745;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
        }
        
        /* Print CSS */
        @media print {
            .no-print, .sidebar, .navbar, .btn, .pagination, 
            .dropdown, .modal, .toast, .alert-dismissible .btn-close,
            .print-hide, .search-filters, .filters, .form-control,
            .page-title-right, .card-header .d-flex .btn, .action-buttons,
            .actions-column, .edit-column, .delete-column, .d-none {
                display: none !important;
            }
            
            * {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            body {
                background-color: white !important;
                color: black !important;
                font-size: 8pt;
                line-height: 1.1;
                margin: 0;
                padding: 0;
                font-family: 'Arial', sans-serif;
            }
            
            .container, .container-fluid {
                    width: 100% !important;
                    max-width: none !important;
                    margin: 0 !important;
                    padding: 8px 0;
                    margin-bottom: 15px;
                    font-weight: bold;
                    font-size: 12pt;
            }
            
            .card-title, h1, h2, h3, h4, h5, h6, .page-title {
                color: black !important;
                text-align: center;
                font-size: 11pt;
                font-weight: bold;
                margin: 5px 0;
            }
            
            .card-body {
                padding: 0 !important;
            }
            
            /* Improve table display */
            .table-responsive {
                overflow: visible !important;
            }
            
            .table {
                border-collapse: collapse !important;
                width: 100% !important;
                margin: 0 !important;
                font-size: 7pt;
                table-layout: auto;
                border: 2px solid #000 !important;
                background-color: white !important;
            }
            
            .table th, .table td {
                border: 1px solid #000 !important;
                padding: 2px 1px !important;
                text-align: center !important;
                word-wrap: break-word;
                vertical-align: middle;
                font-size: 7pt;
                overflow: visible;
                white-space: normal;
                max-width: none;
            }
            
            .table thead th {
                background-color: #e9ecef !important;
                color: black !important;
                font-weight: bold !important;
                font-size: 8pt;
                border: 2px solid #000 !important;
                text-align: center !important;
            }
            
            .table tbody tr:nth-child(even) {
                background-color: #f8f9fa !important;
            }
            
            .table tbody tr:nth-child(odd) {
                background-color: white !important;
            }
            
            /* Hide actions column and buttons properly */
            .table th:last-child, 
            .table td:last-child,
            .table th:nth-last-child(1),
            .table td:nth-last-child(1),
            .table th:nth-last-child(2),
            .table td:nth-last-child(2),
            .actions-column,
            .action-buttons,
            .btn-group,
            .btn-sm,
            .edit-btn,
            .delete-btn,
            .view-btn,
            .operations-column,
            th:contains("Actions"),
            th:contains("Operations"),
            th:contains("Control"),
            th:contains("Manage") {
                display: none !important;
                visibility: hidden !important;
            }
            
            /* Show all important data */
            .table th:not(.actions-column):not([class*="action"]):not([class*="btn"]),
            .table td:not(.actions-column):not([class*="action"]):not([class*="btn"]) {
                display: table-cell !important;
                visibility: visible !important;
            }
            
            /* Improve colored text display */
            .text-primary, .text-success, .text-danger, .text-warning, .text-info, .text-secondary {
                color: black !important;
            }
            
            .badge {
                color: black !important;
                border: 1px solid black !important;
                background-color: white !important;
                font-size: 6pt;
                padding: 1px 3px;
            }
            
            /* Improve financial data display */
            .balance, .amount, .price, .total, .currency {
                font-weight: bold !important;
                text-align: right !important;
                direction: ltr;
            }
            
            /* Enhanced print header */
            .print-header {
                text-align: center;
                margin-bottom: 20px;
                border-bottom: 3px solid #000;
                padding-bottom: 10px;
                background-color: #f8f9fa !important;
                font-size: 14pt;
                font-weight: bold;
            }
            
            .print-date {
                text-align: left;
                margin-bottom: 10px;
                font-size: 7pt;
                border-bottom: 1px solid #666;
                padding-bottom: 3px;
                direction: ltr;
            }
            
            .print-company-info {
                text-align: center;
                margin-bottom: 15px;
                font-size: 10pt;
                font-weight: bold;
                border: 2px solid #000;
                padding: 5px;
                background-color: #f0f0f0 !important;
            }
            
            /* Improve page breaks */
            .page-break {
                page-break-before: always;
            }
            
            @page {
                margin: 0.5cm;
                size: A4 landscape;
            }
            
            /* Prevent breaking rows and important elements */
            .table tr {
                page-break-inside: avoid;
            }
            
            .card {
                page-break-inside: avoid;
            }
            
            /* Advanced page number settings (default EN, overridden below for AR) */
            @page {
                margin: 0.5cm;
                size: A4 landscape;
                @bottom-center {
                    content: "الصفحة " counter(page) " من " counter(pages);
                    font-size: 8pt;
                    font-weight: bold;
                }
                @top-center {
                    content: "تاريخ الطباعة: " attr(data-print-date);
                    font-size: 7pt;
                }
            }
            
            /* Improve long data display */
            .long-text {
                white-space: normal !important;
                word-wrap: break-word !important;
                max-width: 100px;
            }
            
            /* Improve dates and numbers display */
            .date-column, .number-column, .id-column {
                white-space: nowrap !important;
                font-family: 'Courier New', monospace;
                font-size: 7pt;
            }
            
            /* Hide unnecessary elements */
            .search-form, .filter-form, .pagination-wrapper,
            .alert, .message, .notification, .tooltip,
            .popover, .modal-backdrop, .offcanvas {
                display: none !important;
            }
            
            /* Improve numeric data display */
            .numeric-data {
                text-align: right !important;
                font-family: 'Courier New', monospace;
                direction: ltr;
            }
        }
        
        .sidebar {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
        }
        
        .sidebar .nav-link {
            color: rgba(255,255,255,0.8);
            padding: 0.75rem 1rem;
            border-radius: 0.375rem;
            margin: 0.25rem 0;
            transition: all 0.3s ease;
        }
        
        .sidebar .nav-link:hover {
            color: #fff;
            background-color: rgba(255,255,255,0.1);
            transform: translateX(-5px);
        }
        
        :root {
            --sidebar-active-bg: rgba(37, 206, 18, 0.871);
            --sidebar-active-text: #0f0d0d;
            --sidebar-active-border: #ffffff; /* green accent for better visibility */
            --sidebar-active-check-size: 1.1rem; /* adjustable checkmark size */
        }

        .sidebar .nav-link.active {
            color: var(--sidebar-active-text) !important;
            background-color: var(--sidebar-active-bg) !important;
            border-radius: 5px;
            font-weight: bold;
            position: relative;
            /* Space for checkmark indicator */
            padding-inline-end: 1.75rem;
        }

        /* Logical border for active item depending on direction */
        html[dir="ltr"] .sidebar .nav-link.active {
            border-left: 4px solid var(--sidebar-active-border);
            border-right: none;
        }
        html[dir="rtl"] .sidebar .nav-link.active {
            border-right: 4px solid var(--sidebar-active-border);
            border-left: none;
        }

        .sidebar .nav-link.active::before {
            content: "●";
            color: var(--sidebar-active-border);
            font-size: 12px;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            animation: pulse 2s infinite;
        }
        html[dir="ltr"] .sidebar .nav-link.active::before { left: 8px; right: auto; }
        html[dir="rtl"] .sidebar .nav-link.active::before { right: 8px; left: auto; }

        /* Add a clear checkmark indicator on the selected (active) item */
        .sidebar .nav-link.active::after {
            content: "✓";
            color: var(--sidebar-active-border);
            font-size: var(--sidebar-active-check-size);
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
        }
        html[dir="ltr"] .sidebar .nav-link.active::after { right: 10px; left: auto; }
        html[dir="rtl"] .sidebar .nav-link.active::after { left: 10px; right: auto; }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .sidebar .nav-link.active i {
            color: white !important;
        }
        
        /* Highlight main menu containing active page */
        .sidebar .nav-item.has-active-child > a[data-bs-toggle="collapse"] {
            background-color: var(--sidebar-active-bg);
            font-weight: bold;
        }
        html[dir="ltr"] .sidebar .nav-item.has-active-child > a[data-bs-toggle="collapse"] { border-left: 3px solid var(--sidebar-active-border); }
        html[dir="rtl"] .sidebar .nav-item.has-active-child > a[data-bs-toggle="collapse"] { border-right: 3px solid var(--sidebar-active-border); }
        
        .main-content {
            padding: 2rem;
        }
        
        .card {
            border: none;
            border-radius: 0.75rem;
            box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,0.075);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15);
        }
        
        .card-header {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-radius: 0.75rem 0.75rem 0 0 !important;
        }
        
        .navbar {
            background: white !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .company-logo {
            opacity: 0.1;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: -1;
            max-width: 500px;
            max-height: 500px;
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #dc3545;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .stats-card {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-radius: 1rem;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
        }
        
        .btn-primary:hover {
            background: linear-gradient(45deg, #764ba2, #667eea);
            transform: translateY(-1px);
        }
        
        /* Language Selector Styles */
        #languageDropdown {
            color: #495057;
        }
        
        #languageDropdown:hover {
            color: #007bff;
        }
        
        .dropdown-item.active {
            background-color: #f8f9fa;
            color: #007bff;
        }
        
        .dropdown-item button {
            background: none;
            border: none;
            width: 100%;
            text-align: right;
            padding: 0;
            color: inherit;
        }
        
        .dropdown-item:hover button {
            color: inherit;
        }
        
        /* AJAX Loading improvements */
        .main-content {
            min-height: 500px;
            transition: opacity 0.2s ease-in-out;
        }
        
        .sidebar .nav-link.loading {
            opacity: 0.6;
            pointer-events: none;
        }
        
        /* Add effect for active link - unified with variables */
        .sidebar .nav-link.active {
            background-color: var(--sidebar-active-bg) !important;
            color: var(--sidebar-active-text) !important;
        }
    </style>
    
    
<style>
    .form-container {
        background: white;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        padding: 2rem;
    }
    
    .invoice-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 1.5rem;
        border-radius: 8px 8px 0 0;
        margin: -2rem -2rem 2rem -2rem;
    }
    
    .invoice-items {
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 1rem;
        margin-top: 1rem;
    }
    
    .item-row {
        border-bottom: 1px solid #f0f0f0;
        padding: 0.5rem 0;
    }
    
    .item-row:last-child {
        border-bottom: none;
    }
    
    .totals-section {
        background: #f8f9fa;
        padding: 1rem;
        border-radius: 8px;
        margin-top: 1rem;
    }
    
    /* تحسين عرض خانات الكمية والسعر */
    .quantity-input,
    .price-input {
        color: #000 !important;
        background-color: #fff !important;
        font-size: 14px;
        font-weight: 500;
        text-align: right;
        padding: 0.375rem 0.75rem !important;
        min-width: 120px;
        max-width: 100%;
        overflow: visible !important;
        white-space: normal !important;
        word-wrap: break-word !important;
        border: 1px solid #ced4da !important;
        display: block !important;
        width: 100% !important;
        height: auto !important;
        line-height: 1.5 !important;
        transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    }
    
    .quantity-input::placeholder,
    .price-input::placeholder {
        color: #999;
        opacity: 0.7;
    }
    
    .quantity-input:focus,
    .price-input:focus {
        color: #000;
        background-color: #fff;
        border-color: #80bdff !important;
        outline: 0;
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
    }
    
    /* إصلاح الجدول المستجيب */
    .table-responsive {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
    
    #invoice-items-table td {
        vertical-align: middle;
        padding: 0.75rem !important;
    }
</style>

</head>
<body>
    
    <style>
    /* Arabic override for print page counters */
    @page {
        @bottom-center {
            content: "الصفحة " counter(page) " من " counter(pages);
        }
        @top-center {
            content: "تاريخ الطباعة: " attr(data-print-date);
        }
    }
    </style>
    
    <!-- Company Logo Background -->
    
    
    <!-- Top Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <button class="btn btn-outline-secondary d-lg-none me-2" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar" aria-controls="sidebar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand fw-bold" href="/ar/">
                <i class="fas fa-chart-line me-2"></i>
                 - الرئيسية
            </a>
            
            <div class="navbar-nav ms-auto">
                <!-- Language Selector -->
                <div class="nav-item dropdown me-3">
                    <a class="nav-link dropdown-toggle" href="#" id="languageDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-globe me-1"></i>
                        
                        العربية
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <form action="/i18n/setlang/" method="post" style="display: inline;" class="language-form" data-target-lang="ar">
                                <input type="hidden" name="csrfmiddlewaretoken" value="dnUXoReK6a85AAq0IdYGn6jHJq2avsrdn7lPN9nJKlI9FAqiSozB9l5qHgS9D00O">
                                <input name="next" type="hidden" value="/ar/sales/invoices/edit/17/" class="next-field" />
                                <input name="language" type="hidden" value="ar" />
                                <button type="submit" class="dropdown-item active">
                                    <i class="fas fa-check me-2" ></i>
                                    العربية
                                </button>
                            </form>
                        </li>
                        <li>
                            <form action="/i18n/setlang/" method="post" style="display: inline;" class="language-form" data-target-lang="en">
                                <input type="hidden" name="csrfmiddlewaretoken" value="dnUXoReK6a85AAq0IdYGn6jHJq2avsrdn7lPN9nJKlI9FAqiSozB9l5qHgS9D00O">
                                <input name="next" type="hidden" value="/ar/sales/invoices/edit/17/" class="next-field" />
                                <input name="language" type="hidden" value="en" />
                                <button type="submit" class="dropdown-item ">
                                    <i class="fas fa-check me-2" style="visibility: hidden;"></i>
                                    الإنجليزية
                                </button>
                            </form>
                        </li>
                    </ul>
                </div>
                
                <!-- Notifications -->
                
                <div class="nav-item dropdown me-3">
                    <a class="nav-link position-relative" href="/ar/notifications/" id="notificationDropdown">
                        <i class="fas fa-bell fa-lg"></i>
                        
                    </a>
                </div>
                
                <!-- User Menu -->
                <div class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-user me-1"></i>
                        المسؤول الأعلى
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="/ar/settings/"><i class="fas fa-cog me-2"></i>Settings</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="/ar/auth/logout/"><i class="fas fa-sign-out-alt me-2"></i>تسجيل الخروج</a></li>
                    </ul>
                </div>
                
            </div>
        </div>
    </nav>
    
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            
            <nav id="sidebar" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">

                        <!-- البحث الشامل -->
                        <li class="nav-item">
                            <a class="nav-link " href="/ar/search/">
                                <i class="fas fa-search me-2"></i>
                                البحث العام
                            </a>
                        </li>
                        <!-- Dashboard -->
                        <li class="nav-item">
                            <a class="nav-link " href="/ar/">
                                <i class="fas fa-home me-2"></i>
                                لوحة التحكم
                            </a>
                        </li>       

<!--------------------------->
                        <!-- Finance Section -->
                        <li class="nav-item">
                            <a class="nav-link d-flex justify-content-between align-items-center" 
                            data-bs-toggle="collapse" 
                            href="#financeMenu" 
                            role="button" 
                            aria-expanded="false" 
                            aria-controls="financeMenu">
                                <span>
                                    <i class="fas fa-wallet me-2"></i>
                                    المالية
                                </span>
                                <i class="fas fa-chevron-down small"></i>
                            </a>
                            <div class="collapse " id="financeMenu">
                                <ul class="nav flex-column ms-3">
                                    <!-- ضع هنا أكواد البنود الخاصة بالمالية مثل:
                                        Bank Accounts
                                        Cash Boxes
                                        Payment Receipts
                                        Payment Vouchers
                                        Journal Entries
                                        Chart of Accounts
                                        Year-End Closing
                                    -->
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " data-bs-toggle="collapse" href="#banksMenu">
                                            <i class="fas fa-university me-2"></i>
                                            الحسابات البنكية
                                            <i class="fas fa-chevron-down small"></i>
                                        </a>
                                        <div class="collapse " id="banksMenu">
                                            <ul class="nav flex-column ms-3">
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link" href="/ar/banks/accounts/add/">إضافة حساب</a>
                                                </li>
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/banks/accounts/">قائمة الحسابات</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/banks/transfers/">قائمة التحويلات</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/banks/reconciliations/">تسويات البنوك</a>
                                                </li>
                                                </li>
                                            </ul>
                                        </div>
                                    </li>
                                     
                                    <!-- Cashboxes -->
                                    
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="collapse" href="#cashboxesMenu">
                                            <i class="fas fa-cash-register me-2"></i>
                                            الصناديق النقدية
                                            <i class="fas fa-chevron-down small"></i>
                                        </a>
                                        <div class="collapse " id="cashboxesMenu">
                                            <ul class="nav flex-column ms-3">
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/cashboxes/">قائمة الصناديق</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/cashboxes/transfers/">قائمة التحويلات</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </li>
                                    

                                     
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="collapse" href="#receiptsMenu">
                                            <i class="fas fa-receipt me-2"></i>
                                            سندات القبض
                                            <i class="fas fa-chevron-down small"></i>
                                        </a>
                                        <div class="collapse " id="receiptsMenu">
                                            <ul class="nav flex-column ms-3">
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/receipts/add/">إضافة سند قبض</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/receipts/">قائمة سندات القبض</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/receipts/checks/">إدارة الشيكات</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </li>
                                    

                                    <!-- Payment Vouchers -->
                                    
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="collapse" href="#paymentsMenu">
                                            <i class="fas fa-money-bill-wave me-2"></i>
                                            سندات الصرف
                                            <i class="fas fa-chevron-down small"></i>
                                        </a>
                                        <div class="collapse " id="paymentsMenu">
                                            <ul class="nav flex-column ms-3">
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/payments/create/">إضافة سند صرف</a>
                                                </li>
                                                
                                                    <li class="nav-item">
                                                        <a class="nav-link " href="/ar/payments/">قائمة الإيصالات</a>
                                                    </li>
                                            </ul>
                                        </div>
                                    </li>
                                    
                                    
                                    <!-- القيود اليومية -->
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="collapse" href="#journalEntriesMenu">
                                            <i class="fas fa-book me-2"></i>
                                            القيود اليومية
                                            <i class="fas fa-chevron-down small"></i>
                                        </a>
                                        <div class="collapse " id="journalEntriesMenu">
                                            <ul class="nav flex-column ms-3">
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link" href="/ar/journal/entries/">قائمة القيود اليومية</a>
                                                </li>
                                                
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link" href="/ar/journal/accounts/">دليل الحسابات</a>
                                                </li>
                                                
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link" href="/ar/journal/entries/create/">إضافة قيد يومية</a>
                                                </li>
                                                
                                                
                                                
                                                
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link" href="/ar/journal/accounts/create/">إضافة حساب</a>
                                                </li>
                                                
                                            </ul>
                                        </div>
                                    </li>
                                    
                                    
                                    <!-- Revenues & Expenses -->
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="collapse" href="#revenuesExpensesMenu">
                                            <i class="fas fa-chart-line me-2"></i>
                                            الإيرادات والمصروفات
                                            <i class="fas fa-chevron-down small"></i>
                                        </a>
                                        <div class="collapse " id="revenuesExpensesMenu">
                                            <ul class="nav flex-column ms-3">
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/revenues-expenses/">لوحة التحكم</a>
                                                </li>
                                                
                                                <li class="nav-item">
                                                    
                                                        <a class="nav-link " href="/ar/revenues-expenses/categories/">إدارة الفئات</a>
                                                    
                                                </li>
                                                
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/revenues-expenses/entries/">قائمة القيود</a>
                                                </li>
                                                
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/revenues-expenses/entries/create/">إضافة قيد جديد</a>
                                                </li>
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/revenues-expenses/recurring/">الإيراد المتكرر</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </li>
                                    
                                    
                                    <!-- Assets & Liabilities -->
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="collapse" href="#assetsLiabilitiesMenu">
                                            <i class="fas fa-balance-scale me-2"></i>
                                            الأصول والخصوم
                                            <i class="fas fa-chevron-down small"></i>
                                        </a>
                                        <div class="collapse " id="assetsLiabilitiesMenu">
                                            <ul class="nav flex-column ms-3">
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/assets-liabilities/">لوحة التحكم</a>
                                                </li>
                                                
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/assets-liabilities/assets/">قائمة الأصول</a>
                                                </li>
                                                
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/assets-liabilities/liabilities/">قائمة الخصوم</a>
                                                </li>
                                                
                                            </ul>
                                        </div>
                                    </li>
                                    
                                    
                                    <!-- دليل الحسابات
                                    <li class="nav-item">
                                        <a class="nav-link" href="/ar/journal/accounts/">
                                            <i class="fas fa-book me-2"></i>
                                            دليل الحسابات
                                        </a>
                                    </li>
                                    -->
                                    
                                    
                                    <!-- الإقفال السنوي -->
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/journal/year-end-closing/">
                                            <i class="fas fa-calendar-check me-2"></i>
                                            إقفال السنة المالية
                                        </a>
                                    </li>
                                    
                                    
                        
                                </ul>
                            </div>
                        </li>





<!------------->                        
                                     
                        <!-- Bank Accounts (visible if group grants view or edit banks account) -->
                        <!--
                        <li class="nav-item">
                            <a class="nav-link " data-bs-toggle="collapse" href="#banksMenu">
                                <i class="fas fa-university me-2"></i>
                                الحسابات البنكية
                                <i class="fas fa-chevron-down small"></i>
                            </a>
                            <div class="collapse" id="banksMenu">
                                <ul class="nav flex-column ms-3">
                                    
                                    <li class="nav-item">
                                        <a class="nav-link" href="/ar/banks/accounts/add/">إضافة حساب</a>
                                    </li>
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/banks/accounts/">قائمة الحسابات</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/banks/transfers/">قائمة التحويلات</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/banks/reconciliations/">تسويات البنوك</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        
                        
                        <!-- Cashboxes
                        
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#cashboxesMenu">
                                <i class="fas fa-cash-register me-2"></i>
                                الصناديق النقدية
                            </a>
                            <div class="collapse" id="cashboxesMenu">
                                <ul class="nav flex-column ms-3">
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/cashboxes/">قائمة الصناديق</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/cashboxes/transfers/">قائمة التحويلات</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        
                    
                        <!-- Payment Receipts
                        
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#receiptsMenu">
                                <i class="fas fa-receipt me-2"></i>
                                سندات القبض
                            </a>
                            <div class="collapse" id="receiptsMenu">
                                <ul class="nav flex-column ms-3">
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/receipts/add/">إضافة سند قبض</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/receipts/">قائمة سندات القبض</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/receipts/checks/">إدارة الشيكات</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        
                        
                        <!-- Payment Vouchers 
                        
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#paymentsMenu">
                                <i class="fas fa-money-bill-wave me-2"></i>
                                سندات الصرف
                            </a>
                            <div class="collapse" id="paymentsMenu">
                                <ul class="nav flex-column ms-3">
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/payments/create/">إضافة سند صرف</a>
                                    </li>
                                    
                                        <li class="nav-item">
                                            <a class="nav-link " href="/ar/payments/">قائمة الإيصالات</a>
                                        </li>
                                </ul>
                            </div>
                        </li>
                        -->
                        <!-- Sales & Purchases Section -->
                        <li class="nav-item">
                            <a class="nav-link d-flex justify-content-between align-items-center"
                            data-bs-toggle="collapse"
                            href="#salesPurchasesMenu"
                            role="button"
                            aria-expanded="false"
                            aria-controls="salesPurchasesMenu">
                                <span>
                                    <i class="fas fa-shopping-cart me-2"></i>
                                    Sales & Purchases
                                </span>
                                <i class="fas fa-chevron-down small"></i>
                            </a>
                            <div class="collapse show" id="salesPurchasesMenu">
                                <ul class="nav flex-column ms-3">
                                    <!-- ضع هنا أكواد البنود الخاصة بالمبيعات -->
                                    <!-- ضع هنا أكواد البنود الخاصة بالمشتريات -->
                                    <!-- ضع هنا أكواد البنود الخاصة بالعملاء والموردين -->
                                    <!-- Purchases -->
                                    
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="collapse" href="#purchasesMenu">
                                            <i class="fas fa-shopping-cart me-2"></i>
                                            المشتريات
                                            <i class="fas fa-chevron-down small"></i>
                                        </a>
                                        <div class="collapse " id="purchasesMenu">
                                            <ul class="nav flex-column ms-3">
                                                    
                                                        <li class="nav-item">
                                                            <a class="nav-link " href="/ar/purchases/invoices/add/">إضافة فاتورة شراء</a>
                                                        </li>
                                                    
                                                    
                                                        <li class="nav-item">
                                                            <a class="nav-link " href="/ar/purchases/returns/add/">إضافة مرتجع شراء</a>
                                                        </li>
                                                    
                                                         
                                                        <li class="nav-item">
                                                            <a class="nav-link " href="/ar/purchases/invoices/">قائمة فواتير المشتريات</a>
                                                        </li>
                                                    
                                                    
                                                            <li class="nav-item">
                                                                <a class="nav-link " href="/ar/purchases/returns/">قائمة مردودات الشراء</a>
                                                            </li>
                                                    
                                                    
                                                        <li class="nav-item">
                                                            <a class="nav-link " href="/ar/purchases/debit-notes/">إشعارات مدين</a>
                                                        </li>
                                                    
                                                    
                                                        <li class="nav-item">
                                                            <a class="nav-link " href="/ar/purchases/statement/">كشف المشتريات</a>
                                                        </li>
                                                    
                                            </ul>
                                        </div>
                                    </li>
                                    
                                    <!-- Sales -->
                                    
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="collapse" href="#salesMenu">
                                            <i class="fas fa-cash-register me-2"></i>
                                            المبيعات
                                            <i class="fas fa-chevron-down small"></i>
                                        </a>
                                        <div class="collapse show" id="salesMenu">
                                            <ul class="nav flex-column ms-3">
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/sales/invoices/add/">إنشاء فاتورة مبيعات</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/sales/returns/add/">إنشاء مرتجع مبيعات</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/sales/invoices/">قائمة فواتير المبيعات</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/sales/returns/">قائمة مرتجعات المبيعات</a>
                                                </li>
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/sales/credit-notes/">إشعارات الدائن</a>
                                                </li>
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/sales/statement/">كشف المبيعات</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/sales/returns-statement/">كشف مرتجعات المبيعات</a>
                                                </li>
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/sales/pos/">نقطة البيع</a>
                                                </li>
                                                
                                            </ul>
                                        </div>
                                    </li>
                                    
                                    <!-- Customers & Suppliers -->
                                    
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="collapse" href="#customersMenu">
                                            <i class="fas fa-users me-2"></i>
                                            العملاء والموردين
                                            <i class="fas fa-chevron-down small"></i>
                                        </a>
                                        <div class="collapse " id="customersMenu">
                                            <ul class="nav flex-column ms-3">
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/customers/add/">إضافة عميل/مورد</a>
                                                </li>
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/customers/customers/">قائمة العملاء</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/customers/suppliers/">قائمة الموردين</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/customers/">جميع العملاء والموردين</a>
                                                </li>
                                            </ul>
                                        </div>
                                        
                                    </li>
                                </ul>
                            </div>
                        </li>
                        <!-- Inventory & Revenues Section -->
                        <li class="nav-item">
                            <a class="nav-link d-flex justify-content-between align-items-center"
                            data-bs-toggle="collapse"
                            href="#inventoryRevenuesMenu"
                            role="button"
                            aria-expanded="false"
                            aria-controls="inventoryRevenuesMenu">
                                <span>
                                    <i class="fas fa-boxes me-2"></i>
                                    Inventory & Categories & Products
                                </span>
                                <i class="fas fa-chevron-down small"></i>
                            </a>
                            <div class="collapse " id="inventoryRevenuesMenu">
                                <ul class="nav flex-column ms-3">
                                    <!-- ضع هنا أكواد البنود الخاصة بالمخزون -->
                                    <!-- ضع هنا أكواد البنود الخاصة بالفئات والمنتجات -->
                                    <!-- ضع هنا أكواد البنود الخاصة بالإيرادات والمصروفات -->
            <!-- Products & Categories -->
                                    
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="collapse" href="#productsMenu">
                                            <i class="fas fa-boxes me-2"></i>
                                            الفئات والمنتجات
                                            <i class="fas fa-chevron-down small"></i>
                                        </a>
                                        <div class="collapse " id="productsMenu">
                                            <ul class="nav flex-column ms-3">
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/products/categories/add/">إضافة فئة</a>
                                                </li>
                                                
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/products/add/">إضافة منتج</a>
                                                </li>
                                                
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/products/categories/">قائمة الفئات</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/products/">قائمة المنتجات</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </li>
                                    
                        <!-- Inventory -->
                                    
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="collapse" href="#inventoryMenu">
                                            <i class="fas fa-warehouse me-2"></i>
                                            المخزون
                                            <i class="fas fa-chevron-down small"></i>
                                        </a>
                                        <div class="collapse " id="inventoryMenu">
                                            <ul class="nav flex-column ms-3">
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/inventory/">عرض المخزون</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/inventory/warehouses/">المستودعات</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/inventory/movements/">حركة المخزون</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/inventory/transfers/">تحويلات المستودعات</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/inventory/low-stock/">تنبيهات المخزون</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </li>
                                    
                                </ul>
                            </div>
                        </li>
                        
                        <!-- Products & Categories 
                        
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#productsMenu">
                                <i class="fas fa-boxes me-2"></i>
                                الفئات والمنتجات
                            </a>
                            <div class="collapse" id="productsMenu">
                                <ul class="nav flex-column ms-3">
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/products/categories/add/">إضافة فئة</a>
                                    </li>
                                    
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/products/add/">إضافة منتج</a>
                                    </li>
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/products/categories/">قائمة الفئات</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/products/">قائمة المنتجات</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        -->
                        
                        <!-- Customers & Suppliers 
                        
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#customersMenu">
                                <i class="fas fa-users me-2"></i>
                                العملاء والموردين
                            </a>
                            <div class="collapse" id="customersMenu">
                                <ul class="nav flex-column ms-3">
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/customers/add/">إضافة عميل/مورد</a>
                                    </li>
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/customers/customers/">قائمة العملاء</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/customers/suppliers/">قائمة الموردين</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/customers/">جميع العملاء والموردين</a>
                                    </li>
                                </ul>
                            </div>
                            
                        </li>-->
                        
                        <!-- Purchases 
                        
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#purchasesMenu">
                                <i class="fas fa-shopping-cart me-2"></i>
                                المشتريات
                            </a>
                            <div class="collapse" id="purchasesMenu">
                                <ul class="nav flex-column ms-3">
                                        
                                            <li class="nav-item">
                                                <a class="nav-link " href="/ar/purchases/invoices/add/">إضافة فاتورة شراء</a>
                                            </li>
                                        
                                        
                                            <li class="nav-item">
                                                <a class="nav-link " href="/ar/purchases/returns/add/">إضافة مرتجع شراء</a>
                                            </li>
                                        
                                                                                
                                            <li class="nav-item">
                                                <a class="nav-link " href="/ar/purchases/invoices/">قائمة فواتير المشتريات</a>
                                            </li>
                                        
                                        
                                                <li class="nav-item">
                                                    <a class="nav-link " href="/ar/purchases/returns/">قائمة مردودات الشراء</a>
                                                </li>
                                        
                                        
                                            <li class="nav-item">
                                                <a class="nav-link " href="/ar/purchases/debit-notes/">إشعارات مدين</a>
                                            </li>
                                        
                                        
                                            <li class="nav-item">
                                                <a class="nav-link " href="/ar/purchases/statement/">كشف المشتريات</a>
                                            </li>
                                        
                                </ul>
                            </div>
                        </li>
                              -->
                        
                        <!-- Sales 
                        
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#salesMenu">
                                <i class="fas fa-cash-register me-2"></i>
                                المبيعات
                            </a>
                            <div class="collapse" id="salesMenu">
                                <ul class="nav flex-column ms-3">
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/sales/invoices/add/">إنشاء فاتورة مبيعات</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/sales/returns/add/">إنشاء مرتجع مبيعات</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/sales/invoices/">قائمة فواتير المبيعات</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/sales/returns/">قائمة مرتجعات المبيعات</a>
                                    </li>
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/sales/credit-notes/">إشعارات الدائن</a>
                                    </li>
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/sales/statement/">كشف المبيعات</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/sales/returns-statement/">كشف مرتجعات المبيعات</a>
                                    </li>
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/sales/pos/">نقطة البيع</a>
                                    </li>
                                    
                                </ul>
                            </div>
                        </li>
                        -->
                        
                        <!-- Inventory 
                        
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#inventoryMenu">
                                <i class="fas fa-warehouse me-2"></i>
                                المخزون
                            </a>
                            <div class="collapse" id="inventoryMenu">
                                <ul class="nav flex-column ms-3">
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/inventory/">عرض المخزون</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/inventory/warehouses/">المستودعات</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/inventory/movements/">حركة المخزون</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/inventory/low-stock/">تنبيهات المخزون</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        -->
                        

<!--                        
                        <!-- Revenues & Expenses
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#revenuesExpensesMenu">
                                <i class="fas fa-chart-line me-2"></i>
                                الإيرادات والمصروفات
                            </a>
                            <div class="collapse" id="revenuesExpensesMenu">
                                <ul class="nav flex-column ms-3">
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/revenues-expenses/">لوحة التحكم</a>
                                    </li>
                                    
                                    <li class="nav-item">
                                        
                                            <a class="nav-link " href="/ar/revenues-expenses/categories/">إدارة الفئات</a>
                                        
                                    </li>
                                    
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/revenues-expenses/entries/">قائمة القيود</a>
                                    </li>
                                    
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/revenues-expenses/entries/create/">إضافة قيد جديد</a>
                                    </li>
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/revenues-expenses/recurring/">الإيراد المتكرر</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        -->
                        


<!--                        
                        <!-- القيود اليومية 
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#journalEntriesMenu">
                                <i class="fas fa-book me-2"></i>
                        القيود اليومية
                            </a>
                            <div class="collapse" id="journalEntriesMenu">
                                <ul class="nav flex-column ms-3">
                                    
                                    <li class="nav-item">
                                        <a class="nav-link" href="/ar/journal/entries/">قائمة القيود اليومية</a>
                                    </li>
                                    
                                    
                                    <li class="nav-item">
                                        <a class="nav-link" href="/ar/journal/accounts/">دليل الحسابات</a>
                                    </li>
                                    
                                    
                                    <li class="nav-item">
                                        <a class="nav-link" href="/ar/journal/entries/create/">إضافة قيد يومية</a>
                                    </li>
                                    
                                    
                                    
                                    
                                    
                                    <li class="nav-item">
                                        <a class="nav-link" href="/ar/journal/accounts/create/">إضافة حساب</a>
                                    </li>
                                    
                                </ul>
                            </div>
                        </li>
                        -

                        
                        <!-- دليل الحسابات 
                        <li class="nav-item">
                            <a class="nav-link" href="/ar/journal/accounts/">
                                <i class="fas fa-book me-2"></i>
                                دليل الحسابات
                            </a>
                        </li>
                        
                        
                        
                        <!-- الإقفال السنوي 
                        <li class="nav-item">
                            <a class="nav-link " href="/ar/journal/year-end-closing/">
                                <i class="fas fa-calendar-check me-2"></i>
                                إقفال السنة المالية
                            </a>
                        </li>
                        -->
                        
<!--                        
                        <!-- Assets & Liabilities
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#assetsLiabilitiesMenu">
                                <i class="fas fa-balance-scale me-2"></i>
                                الأصول والخصوم
                            </a>
                            <div class="collapse" id="assetsLiabilitiesMenu">
                                <ul class="nav flex-column ms-3">
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/assets-liabilities/">لوحة التحكم</a>
                                    </li>
                                    
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/assets-liabilities/assets/">قائمة الأصول</a>
                                    </li>
                                    
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/assets-liabilities/liabilities/">قائمة الخصوم</a>
                                    </li>
                                    
                                </ul>
                            </div>
                        </li>
                        -->

                        <!-- Reports -->
                        
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#reportsMenu">
                                <i class="fas fa-chart-bar me-2"></i>
                                التقارير
                                <i class="fas fa-chevron-down small"></i>
                            </a>
                            <div class="collapse " id="reportsMenu">
                                <ul class="nav flex-column ms-3">
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/sales/reports/">تقارير المبيعات</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/reports/sales-by-salesperson/">تقرير المبيعات حسب مندوب المبيعات</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/purchases/reports/">تقارير المشتريات</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/reports/tax/">تقرير الضرائب</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/reports/profit-loss/">الأرباح والخسائر</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/reports/customer-statement/">كشف حساب العميل</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/reports/trial-balance/">الميزان التجريبي</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/reports/balance-sheet/">الميزانية العمومية</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/reports/income-statement/">قائمة الدخل</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/reports/cash-flow/">بيان التدفق النقدي</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/reports/aging-report/">تقرير أعمار الذمم</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/reports/inventory-report/">تقرير أرصدة المخزون</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/reports/financial-ratios/">النسب المالية</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/documents/report/">تقرير المستندات</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        
                        
                        <!-- Human Resources
                        
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#hrMenu">
                                <i class="fas fa-users-cog me-2"></i>
                                الموارد البشرية
                                <i class="fas fa-chevron-down small"></i>
                            </a>
                            <div class="collapse " id="hrMenu">
                                <ul class="nav flex-column ms-3">
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/hr/">لوحة تحكم الموارد البشرية</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/hr/employees/">الموظفون</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/hr/departments/">الأقسام</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/hr/positions/">الوظائف</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/hr/attendance/">الحضور</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/hr/leaves/">طلبات الإجازة</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/hr/payroll/">الرواتب</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/hr/reports/">تقارير الموارد البشرية</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        -->
                        
                        <!-- System Management -->
                        
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="collapse" href="#systemMenu">
                                <i class="fas fa-cogs me-2"></i>
                                إدارة النظام
                                <i class="fas fa-chevron-down small"></i>
                            </a>
                            <div class="collapse " id="systemMenu">
                                <ul class="nav flex-column ms-3">
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/users/add/">إضافة مستخدم</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/users/">قائمة المستخدمين</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/users/groups/">المجموعات والصلاحيات</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/audit-log/">
                                            <i class="fas fa-history me-2"></i>
                                            سجل الأنشطة
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/settings/document-sequences/">إدارة أرقام المستندات</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/settings/company/">إعدادات النظام</a>
                                    </li>
                                    
                                    <!-- System Management - For Super Admin and Admin -->
                                    
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/settings/superadmin-management/">
                                            <i class="fas fa-crown me-2 text-warning"></i>
                                            إدارة النظام
                                            <span class="badge bg-danger ms-1">متقدم</span>
                                        </a>
                                    </li>
                                    
                                    <!-- Print Design Settings -->
                                    
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/settings/print-design/">
                                            <i class="fas fa-paint-brush me-2 text-success"></i>
                                            تصميم الطباعة
                                        </a>
                                    </li>
                                    
                                    <!-- JoFotara Settings -->
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/settings/jofotara-settings/">
                                            <i class="fas fa-link me-2 text-info"></i>
                                            إعدادات JoFotara
                                        </a>
                                    </li>
                                    
                                    
                                    <!-- Backup and Restore -->
                                    <li class="nav-item">
                                        <a class="nav-link " href="/ar/backup/">
                                            <i class="fas fa-database me-2 text-info"></i>
                                            النسخ الاحتياطي
                                        </a>
                                    </li>
                                    
                                </ul>
                            </div>
                        </li>
                        
                    </ul>
                </div>
            </nav>
            
            
            <!-- Main Content -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="main-content" id="main-content">
                    
                    
                    
<div class="container-fluid">
    <!-- Page Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="mb-0">
                <i class="fas fa-edit text-warning me-2"></i>
                تعديل فاتورة المبيعات
            </h2>
            <p class="text-muted mb-0">تعديل بيانات فاتورة المبيعات رقم MANUAL-TEST-11</p>
        </div>
        <div>
            <a href="/ar/sales/invoices/" class="btn btn-secondary me-2">
                <i class="fas fa-arrow-right me-1"></i>
                العودة للقائمة
            </a>
            <a href="/ar/sales/invoices/17/" class="btn btn-info">
                <i class="fas fa-eye me-1"></i>
                عرض الالتفاصيل
            </a>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div class="form-container">
                <div class="invoice-header">
                    <div class="row">
                        <div class="col-md-6">
                            <h4 class="mb-0">
                                <i class="fas fa-file-invoice-dollar me-2"></i>
                                تعديل فاتورة المبيعات
                            </h4>
                        </div>
                        <div class="col-md-6 text-end">
                            <h5 class="mb-0">رقم الفاتورة: MANUAL-TEST-11</h5>
                        </div>
                    </div>
                </div>

                
                
                <form method="post">
                    <input type="hidden" name="csrfmiddlewaretoken" value="dnUXoReK6a85AAq0IdYGn6jHJq2avsrdn7lPN9nJKlI9FAqiSozB9l5qHgS9D00O">
                    <input type="hidden" name="inclusive_tax" value="0">
                    
                    <div class="row">
                        <!-- Basic Invoice Information -->
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="id_invoice_number" class="form-label">
                                    <i class="fas fa-hashtag text-primary me-1"></i>
                                    رقم الفاتورة
                                </label>
                                <input type="text" name="invoice_number" value="MANUAL-TEST-11" maxlength="50" class="form-control" required id="id_invoice_number">
                                
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="id_date" class="form-label">
                                    <i class="fas fa-calendar text-primary me-1"></i>
                                    التاريخ
                                </label>
                                <input type="text" name="date" value="2025-10-18" class="form-control" type="date" required id="id_date">
                                
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="id_customer" class="form-label">
                                    <i class="fas fa-user text-primary me-1"></i>
                                    العميل
                                </label>
                                <select name="customer" class="form-select" id="id_customer">
  <option value="">---------</option>

  <option value="1" selected>شركة التقنية المتقدمة - المحدثة (العميل)</option>

  <option value="2">مؤسسة الأمل التجارية (العميل)</option>

  <option value="3">شركة النجاح الدولية (العميل)</option>

  <option value="4">مكتبة القراءة الحديثة (العميل)</option>

  <option value="5">شركة البناء السريع (العميل)</option>

  <option value="45">عميل اختبار سندات القبض (العميل)</option>

  <option value="17">عميل اختبار سريع 1 (العميل)</option>

  <option value="19">عميل اختبار سريع 1 (العميل)</option>

  <option value="21">عميل اختبار سريع 1 (العميل)</option>

  <option value="23">عميل اختبار سريع 1 (العميل)</option>

  <option value="93">Cash Customer (العميل)</option>

  <option value="9">الشركة العالمية للتجارة والصناعة (العميل والمورد)</option>

  <option value="10">مؤسسة الشرق الأوسط المتحدة (العميل والمورد)</option>

</select>
                                
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="id_payment_type" class="form-label">
                                    <i class="fas fa-credit-card text-primary me-1"></i>
                                    نوع الدفعة
                                </label>
                                <select name="payment_type" class="form-select" required id="id_payment_type">
  <option value="">---------</option>

  <option value="cash">نقدي</option>

  <option value="credit" selected>ذمم</option>

  <option value="bank_transfer">تحويل بنكي</option>

  <option value="check">شيك</option>

  <option value="installment">تقسيط</option>

</select>
                                
                            </div>
                        </div>
                    </div>

                    <!-- صف المستودع -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label"><i class="fas fa-warehouse me-1"></i> المستودع</label>
                                <select class="form-select" name="warehouse">
                                    <option value="">اختر المستودع</option>
                                    
                                    <option value="1" selected>
                                        مستودع اختبار رئيسي - WH-TEST-MAIN
                                         (افتراضي)
                                    </option>
                                    
                                    <option value="2" >
                                        مستودع اختبار فرعي 1 - WH-TEST-SUB1
                                        
                                    </option>
                                    
                                    <option value="3" >
                                        مستودع اختبار فرعي 2 - WH-TEST-SUB2
                                        
                                    </option>
                                    
                                </select>
                                <div class="form-text">Select the warehouse from which products will be sold.</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            
                            <div class="mb-3">
                                <label class="form-label">
                                    <i class="fas fa-user-edit text-warning me-1"></i> 
                                    أنشئ بواسطة
                                </label>
                                <select class="form-select" name="created_by">
                                    
                                    <option value="4" >
                                        pos user
                                    </option>
                                    
                                    <option value="2" selected>
                                        المسؤول الأعلى
                                    </option>
                                    
                                    <option value="3" >
                                        قاسم أول
                                    </option>
                                    
                                    <option value="1" >
                                        مسؤول النظام
                                    </option>
                                    
                                </select>
                                <div class="form-text text-warning">
                                    <i class="fas fa-exclamation-triangle me-1"></i>
                                    تغيير المنشئ يتطلب صلاحية خاصة
                                </div>
                            </div>
                            
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12">
                            <div class="mb-3">
                                <label for="id_notes" class="form-label">
                                    <i class="fas fa-sticky-note text-primary me-1"></i>
                                    ملاحظات
                                </label>
                                <textarea name="notes" cols="40" rows="3" class="form-control" placeholder="أدخل ملاحظات إضافية..." id="id_notes">
</textarea>
                                
                            </div>
                        </div>
                    </div>

                    <!-- Invoice Items Display -->
                    <div class="invoice-items">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="mb-0">
                                <i class="fas fa-list text-primary me-2"></i>
                                عناصر الفاتورة
                            </h5>
                            <button type="button" class="btn btn-success btn-sm" id="add-item-btn">
                                <i class="fas fa-plus me-1"></i>
                                إضافة منتج
                            </button>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-hover" id="invoice-items-table">
                                <thead class="table-light">
                                    <tr>
                                        <th>المنتج</th>
                                        <th>الكمية</th>
                                        <th>سعر الوحدة</th>
                                        <th>نسبة الضريبة</th>
                                        <th>مبلغ الضريبة</th>
                                        <th>الإجمالي</th>
                                        <th>الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    
                                    <tr data-item-id="37">
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <span class="product-name">كاميرا ويب Logitech C920</span>
                                                <small class="text-muted ms-2">(CAM-LOG-001)</small>
                                            </div>
                                        </td>
                                        <td>
                                            <input type="number" class="form-control form-control-sm quantity-input" 
                                                   value="3.000" min="0.01" step="0.01" 
                                                   data-item-id="37">
                                        </td>
                                        <td>
                                            <input type="number" class="form-control form-control-sm price-input" 
                                                   value="800.000" min="0" step="0.01" 
                                                   data-item-id="37">
                                        </td>
                                        <td>15,00%</td>
                                        <td class="tax-amount">360.000 د.أ</td>
                                        <td class="total-amount"><strong>2760.000 د.أ</strong></td>
                                        <td>
                                            <button type="button" class="btn btn-warning btn-sm edit-item-btn" 
                                                    data-item-id="37">
                                                <i class="fas fa-save"></i>
                                            </button>
                                            <button type="button" class="btn btn-danger btn-sm delete-item-btn" 
                                                    data-item-id="37">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Add New Item Form -->
                        <div id="add-item-form" class="mt-3" style="display: none;">
                            <div class="card border-success">
                                <div class="card-header bg-success text-white">
                                    <h6 class="mb-0">
                                        <i class="fas fa-plus me-2"></i>
                                        إضافة منتج جديد
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label class="form-label">المنتج</label>
                                            <select class="form-select" id="new-product-select">
                                                <option value="">اختر المنتج...</option>
                                                
                                                <option value="54" data-code="SRV-OS-001" 
                                                        data-price="100,000" 
                                                        data-tax="5,00">
                                                    خدمة تثبيت نظام تشغيل (SRV-OS-001)
                                                </option>
                                                
                                                <option value="55" data-code="SRV-ASSEM-001" 
                                                        data-price="200,000" 
                                                        data-tax="10,00">
                                                    خدمة تجميع كمبيوتر (SRV-ASSEM-001)
                                                </option>
                                                
                                                <option value="57" data-code="SRV-NET-001" 
                                                        data-price="300,000" 
                                                        data-tax="0,00">
                                                    خدمة تركيب شبكة (SRV-NET-001)
                                                </option>
                                                
                                                <option value="56" data-code="SRV-SUPP-001" 
                                                        data-price="1200,000" 
                                                        data-tax="0,00">
                                                    خدمة دعم فني سنوي (SRV-SUPP-001)
                                                </option>
                                                
                                                <option value="53" data-code="SRV-MAINT-001" 
                                                        data-price="150,000" 
                                                        data-tax="0,00">
                                                    خدمة صيانة كمبيوتر (SRV-MAINT-001)
                                                </option>
                                                
                                                <option value="41" data-code="RAM-KIN-001" 
                                                        data-price="350,000" 
                                                        data-tax="0,00">
                                                    ذاكرة عشوائية Kingston 16GB DDR4 (RAM-KIN-001)
                                                </option>
                                                
                                                <option value="50" data-code="ROU-TPL-001" 
                                                        data-price="600,000" 
                                                        data-tax="0,00">
                                                    راوتر TP-Link Archer AX3000 (ROU-TPL-001)
                                                </option>
                                                
                                                <option value="48" data-code="HEAD-HYP-001" 
                                                        data-price="550,000" 
                                                        data-tax="0,00">
                                                    سماعة رأس HyperX Cloud II (HEAD-HYP-001)
                                                </option>
                                                
                                                <option value="43" data-code="MON-DELL-001" 
                                                        data-price="1500,000" 
                                                        data-tax="0,00">
                                                    شاشة Dell 27 بوصة 4K (MON-DELL-001)
                                                </option>
                                                
                                                <option value="45" data-code="MON-LG-001" 
                                                        data-price="720,000" 
                                                        data-tax="0,00">
                                                    شاشة LG 24 بوصة Full HD (MON-LG-001)
                                                </option>
                                                
                                                <option value="44" data-code="PRT-HP-001" 
                                                        data-price="1100,000" 
                                                        data-tax="0,00">
                                                    طابعة HP LaserJet Pro (PRT-HP-001)
                                                </option>
                                                
                                                <option value="46" data-code="MOU-LOG-001" 
                                                        data-price="480,000" 
                                                        data-tax="0,00">
                                                    فأرة Logitech MX Master 3 (MOU-LOG-001)
                                                </option>
                                                
                                                <option value="52" data-code="SSD-SAM-001" 
                                                        data-price="620,000" 
                                                        data-tax="0,00">
                                                    قرص SSD Samsung 1TB NVMe (SSD-SAM-001)
                                                </option>
                                                
                                                <option value="49" data-code="CAM-LOG-001" 
                                                        data-price="380,000" 
                                                        data-tax="16,00">
                                                    كاميرا ويب Logitech C920 (CAM-LOG-001)
                                                </option>
                                                
                                                <option value="40" data-code="GPU-NV-001" 
                                                        data-price="2800,000" 
                                                        data-tax="0,00">
                                                    كرت شاشة NVIDIA RTX 3060 (GPU-NV-001)
                                                </option>
                                                
                                                <option value="38" data-code="PC-MSI-001" 
                                                        data-price="6800,000" 
                                                        data-tax="0,00">
                                                    كمبيوتر ألعاب MSI Gaming (PC-MSI-001)
                                                </option>
                                                
                                                <option value="36" data-code="PC-HP-001" 
                                                        data-price="3400,000" 
                                                        data-tax="0,00">
                                                    كمبيوتر مكتبي HP EliteDesk (PC-HP-001)
                                                </option>
                                                
                                                <option value="35" data-code="LAP-DELL-001" 
                                                        data-price="4200,000" 
                                                        data-tax="0,00">
                                                    لابتوب Dell Latitude 5520 (LAP-DELL-001)
                                                </option>
                                                
                                                <option value="37" data-code="LAP-LEN-001" 
                                                        data-price="3500,000" 
                                                        data-tax="0,00">
                                                    لابتوب Lenovo ThinkPad E14 (LAP-LEN-001)
                                                </option>
                                                
                                                <option value="42" data-code="MB-ASUS-001" 
                                                        data-price="1100,000" 
                                                        data-tax="0,00">
                                                    لوحة أم ASUS ROG Strix B550 (MB-ASUS-001)
                                                </option>
                                                
                                                <option value="47" data-code="KB-COR-001" 
                                                        data-price="850,000" 
                                                        data-tax="0,00">
                                                    لوحة مفاتيح ميكانيكية Corsair K70 (KB-COR-001)
                                                </option>
                                                
                                                <option value="39" data-code="CPU-INT-001" 
                                                        data-price="2200,000" 
                                                        data-tax="0,00">
                                                    معالج Intel Core i7-12700K (CPU-INT-001)
                                                </option>
                                                
                                                <option value="51" data-code="HDD-SEA-001" 
                                                        data-price="420,000" 
                                                        data-tax="0,00">
                                                    هارد خارجي Seagate 2TB (HDD-SEA-001)
                                                </option>
                                                
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">الكمية</label>
                                            <input type="number" class="form-control" id="new-quantity" 
                                                   min="0.01" step="0.01" placeholder="0.00">
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">سعر الوحدة</label>
                                            <input type="number" class="form-control" id="new-price" 
                                                   min="0" step="0.01" placeholder="0.00">
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">نسبة الضريبة</label>
                                            <input type="number" class="form-control" id="new-tax-rate" 
                                                   min="0" max="100" step="0.01" placeholder="0.00">
                                        </div>
                                        <div class="col-md-2 d-flex align-items-end">
                                            <button type="button" class="btn btn-success me-2" id="save-new-item-btn">
                                                <i class="fas fa-save me-1"></i>
                                                حفظ
                                            </button>
                                            <button type="button" class="btn btn-secondary" id="cancel-add-item-btn">
                                                <i class="fas fa-times me-1"></i>
                                                إلغاء
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="totals-section">
                            <div class="row">
                                <div class="col-md-6"></div>
                                <div class="col-md-6">
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>الإجمالي الفرعي:</span>
                                        <strong id="invoice-subtotal-display">2400.000 د.أ</strong>
                                    </div>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>مبلغ الضريبة:</span>
                                        <strong id="invoice-tax-display">360.000 د.أ</strong>
                                    </div>
                                    <div class="d-flex justify-content-between mb-2 align-items-center">
                                        <div>
                                            <label class="form-check-label me-2">شامل ضريبة</label>
                                            <input type="checkbox" id="id_inclusive_tax_edit" name="inclusive_tax" value="1" checked
                                                   >
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>مبلغ الخصم:</span>
                                        <strong id="invoice-discount-display">0.000 د.أ</strong>
                                    </div>
                                    <hr>
                                    <div class="d-flex justify-content-between">
                                        <span class="h5">الإجمالي الإجمالي:</span>
                                        <strong class="h5 text-primary" id="invoice-total-display">2760.000 د.أ</strong>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-flex justify-content-end mt-4">
                        <a href="/ar/sales/invoices/17/" class="btn btn-secondary me-2">
                            <i class="fas fa-times me-1"></i>
                            إلغاء
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-1"></i>
                            حفظ التغييرات
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

                </div>
            </main>
        </div>
    </div>
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        
        // وظيفة لمسح جميع الحالات النشطة
        function clearAllActiveStates() {
            document.querySelectorAll('.sidebar .nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            document.querySelectorAll('.sidebar .nav-item').forEach(navItem => {
                navItem.classList.remove('has-active-child');
            });
            
            document.querySelectorAll('.sidebar .collapse').forEach(collapse => {
                collapse.classList.remove('show');
            });
        }
        
        // وظيفة لمسح جميع الحالات النشطة مع تأثير انيميشن
        function clearAllActiveStates() {
            // إزالة جميع active classes من الروابط مع تأثير تدريجي
            document.querySelectorAll('.sidebar .nav-link.active').forEach(link => {
                link.style.transition = 'all 0.3s ease';
                link.classList.remove('active');
            });
            
            // إزالة has-active-child من جميع عناصر nav-item
            document.querySelectorAll('.sidebar .nav-item.has-active-child').forEach(item => {
                item.style.transition = 'all 0.3s ease';
                item.classList.remove('has-active-child');
            });
        }
        
        // وظيفة لإضافة تأثير بصري عند التفعيل
        function activateWithEffect(element) {
            element.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
            element.classList.add('active');
            
            // إضافة تأثير pulse مؤقت
            element.style.transform = 'translateX(-5px) scale(1.02)';
            setTimeout(() => {
                element.style.transform = 'translateX(-3px)';
            }, 200);
        }
        
        // وظيفة تحديد العنصر النشط بناءً على URL الحالي
        function setActiveSidebarItem() {
            const currentPath = window.location.pathname;
            
            // مسح جميع الحالات أولاً
            clearAllActiveStates();
            
            // للصفحة الرئيسية، نشط رابط Dashboard
            if (currentPath === '/' || currentPath === '/ar/' || currentPath === '/en/') {
                const dashboardLink = document.querySelector('.sidebar .nav-link[href="/ar/"], .sidebar .nav-link[href="/"], .sidebar .nav-link[href="/en/"]');
                if (dashboardLink) {
                    activateWithEffect(dashboardLink);
                }
                return;
            }
            
            // البحث عن أفضل مطابقة
            let bestMatch = null;
            let bestScore = -1;
            
            document.querySelectorAll('.sidebar .nav-link[href]').forEach(link => {
                const href = link.getAttribute('href');
                if (!href || href === '#') return;
                
                try {
                    const url = new URL(href, window.location.origin);
                    const linkPath = url.pathname;
                    
                    // تجاهل المسارات الجذر
                    if (linkPath === '/' || linkPath === '/ar/' || linkPath === '/en/') return;
                    
                    // تحقق من المطابقة
                    if (currentPath.startsWith(linkPath)) {
                        const score = linkPath.length;
                        if (score > bestScore) {
                            bestMatch = link;
                            bestScore = score;
                        }
                    }
                } catch (e) {
                    // تجاهل الأخطاء
                }
            });
            
            // تطبيق أفضل مطابقة
            if (bestMatch) {
                // تعيين الرابط كنشط مع تأثير بصري
                activateWithEffect(bestMatch);
                
                // البحث عن القائمة الفرعية الأب
                const parentCollapse = bestMatch.closest('.collapse[id]');
                if (parentCollapse) {
                    // فتح القائمة الفرعية مع تأثير سلس
                    parentCollapse.style.transition = 'all 0.3s ease';
                    parentCollapse.classList.add('show');
                    
                    // البحث عن زر القائمة الرئيسية
                    const menuButton = document.querySelector(`[href="#${parentCollapse.id}"]`);
                    if (menuButton) {
                        const parentNavItem = menuButton.closest('.nav-item');
                        if (parentNavItem) {
                            parentNavItem.style.transition = 'all 0.3s ease';
                            parentNavItem.classList.add('has-active-child');
                        }
                    }
                }
            }
        }
        
        // تشغيل الوظيفة عند تحميل الصفحة
        setActiveSidebarItem();
        
        // إعادة تشغيل الوظيفة عند النقر على روابط الشريط الجانبي
        document.querySelectorAll('.sidebar .nav-link[href]').forEach(link => {
            link.addEventListener('click', function() {
                setTimeout(setActiveSidebarItem, 100);
            });
        });

        // تعطيل localStorage مؤقتاً للاختبار
        // localStorage menu state management is temporarily disabled for testing
        /*
        // Restore submenu open state from localStorage (but don't override active page detection)
        document.querySelectorAll('.sidebar .collapse[id]').forEach(col => {
            const saved = localStorage.getItem('sidebar_' + col.id);
            if (saved === 'open' && !col.classList.contains('show')) {
                col.classList.add('show');
                // Ensure toggler reflects expanded state
                const toggler = document.querySelector('.sidebar a[data-bs-toggle="collapse"][href="#' + col.id + '"]');
                if (toggler) toggler.setAttribute('aria-expanded', 'true');
            } else if (saved === 'closed') {
                col.classList.remove('show');
                const toggler = document.querySelector('.sidebar a[data-bs-toggle="collapse"][href="#' + col.id + '"]');
                if (toggler) toggler.setAttribute('aria-expanded', 'false');
            }
        });

        // When clicking any leaf link, persist its parent menu as open
        const leafLinks = document.querySelectorAll('.sidebar .nav-link[href]:not([data-bs-toggle])');
        leafLinks.forEach(a => {
            a.addEventListener('click', function() {
                const parentCol = this.closest('.collapse[id]');
                // Close all others in localStorage so only one remains open
                document.querySelectorAll('.sidebar .collapse[id]').forEach(c => {
                    if (c !== parentCol && c.id) {
                        localStorage.setItem('sidebar_' + c.id, 'closed');
                    }
                });
                if (parentCol && parentCol.id) {
                    localStorage.setItem('sidebar_' + parentCol.id, 'open');
                }
            });
        });
        */

        // تعطيل التنقل الجزئي (AJAX) افتراضياً لتفادي فقدان الأنماط والسكربتات
        // فعِّله بوضع window.ENABLE_AJAX_NAV = true قبل هذا السكربت إن رغبت.
        if (window.ENABLE_AJAX_NAV !== true) {
            return;
        }
        
        // Handle clicks on sidebar links
        const sidebarLinks = document.querySelectorAll('.sidebar .nav-link[href]:not([data-bs-toggle])');
        
        sidebarLinks.forEach(link => {
            // Ignore links that open dropdowns or external links
            if (link.getAttribute('data-bs-toggle') === 'collapse' || 
                link.href.startsWith('mailto:') || 
                link.href.startsWith('tel:') ||
                link.href.includes('#') ||
                link.href.includes('admin:logout') ||
                link.closest('[data-bs-toggle="collapse"]')) {
                return;
            }
            
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                const url = this.href;
                const mainContent = document.getElementById('main-content');
                
                // Avoid reloading the same page
                if (window.location.href === url) {
                    return;
                }
                
                // إضافة loading indicator
                this.classList.add('loading');
                mainContent.style.opacity = '0.5';
                
                // إضافة spinner
                const loadingDiv = document.createElement('div');
                loadingDiv.className = 'position-absolute top-50 start-50 translate-middle';
                loadingDiv.innerHTML = `
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">جاري التحميل...</span>
                    </div>
                `;
                mainContent.style.position = 'relative';
                mainContent.appendChild(loadingDiv);
                
                // Send AJAX request
                fetch(url, {
                    method: 'GET',
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest',
                        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'
                    }
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.text();
                })
                .then(html => {
                    // Extract content from loaded page
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    const newContent = doc.querySelector('.main-content, #main-content');
                    
                    if (newContent) {
                        // Remove loading state
                        this.classList.remove('loading');
                        loadingDiv.remove();
                        
                        // Update content
                        mainContent.innerHTML = newContent.innerHTML;
                        mainContent.style.opacity = '1';
                        
                        // Update URL in address bar
                        history.pushState({url: url}, '', url);
                        
                        // Execute any new scripts in content
                        const scripts = mainContent.querySelectorAll('script');
                        scripts.forEach(script => {
                            if (script.src) {
                                // For external scripts
                                const newScript = document.createElement('script');
                                newScript.src = script.src;
                                document.head.appendChild(newScript);
                            } else {
                                // For inline scripts
                                const newScript = document.createElement('script');
                                newScript.textContent = script.textContent;
                                document.body.appendChild(newScript);
                            }
                        });
                        
                        // Update page title
                        const newTitle = doc.querySelector('title');
                        if (newTitle) {
                            document.title = newTitle.textContent;
                        }
                        
                        // Reinitialize Bootstrap components if needed
                        if (typeof bootstrap !== 'undefined') {
                            // Reinitialize tooltips and popovers
                            const tooltipTriggerList = [].slice.call(mainContent.querySelectorAll('[data-bs-toggle="tooltip"]'));
                            tooltipTriggerList.map(function (tooltipTriggerEl) {
                                return new bootstrap.Tooltip(tooltipTriggerEl);
                            });
                        }
                    } else {
                        throw new Error('Content not found in response');
                    }
                })
                .catch(error => {
                    console.error('Error loading page:', error);
                    // On error, remove loading and navigate normally
                    this.classList.remove('loading');
                    if (loadingDiv.parentNode) {
                        loadingDiv.remove();
                    }
                    mainContent.style.opacity = '1';
                    
                    // Normal redirect as fallback
                    window.location.href = url;
                });
                
                // Update active link using enhanced function
                setActiveSidebarItem();
            });
        });
        
        // Handle browser buttons (Back/Forward)
        window.addEventListener('popstate', function(e) {
            if (e.state && e.state.url) {
                // Load saved page from history
                const url = e.state.url;
                const mainContent = document.getElementById('main-content');
                
                fetch(url, {
                    method: 'GET',
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                })
                .then(response => response.text())
                .then(html => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    const newContent = doc.querySelector('.main-content, #main-content');
                    
                    if (newContent) {
                        mainContent.innerHTML = newContent.innerHTML;
                        
                        // Update title
                        const newTitle = doc.querySelector('title');
                        if (newTitle) {
                            document.title = newTitle.textContent;
                        }
                        
                        // Update active link in sidebar
                        setActiveSidebarItem();
                    }
                })
                .catch(() => {
                    window.location.reload();
                });
            } else {
                // If no saved state exists, reload page
                window.location.reload();
            }
        });
        
        // Handle dropdown menu open/close (close others when opening new one)
        const collapseToggleLinks = document.querySelectorAll('.sidebar a[data-bs-toggle="collapse"]');
        collapseToggleLinks.forEach(link => {
            link.addEventListener('click', function() {
                const targetCollapse = document.querySelector(this.getAttribute('href'));
                const isCurrentlyCollapsed = !targetCollapse.classList.contains('show');
                
                if (isCurrentlyCollapsed) {
                    // If current menu is closed and will be opened, close all other menus
                    const allCollapses = document.querySelectorAll('.sidebar .collapse.show');
                    allCollapses.forEach(collapse => {
                        if (collapse !== targetCollapse) {
                            const bsCollapse = bootstrap.Collapse.getInstance(collapse);
                            if (bsCollapse) {
                                bsCollapse.hide();
                            } else {
                                const newBsCollapse = new bootstrap.Collapse(collapse, {show: false});
                                newBsCollapse.hide();
                            }
                        }
                    });
                }
            });
        });
        
        // Save dropdown menu states
        const collapseElements = document.querySelectorAll('.sidebar .collapse');
        collapseElements.forEach(collapse => {
            collapse.addEventListener('shown.bs.collapse', function() {
                localStorage.setItem('sidebar_' + this.id, 'open');
            });
            
            collapse.addEventListener('hidden.bs.collapse', function() {
                localStorage.setItem('sidebar_' + this.id, 'closed');
            });
            
            // Restore menu states on page load
            const savedState = localStorage.getItem('sidebar_' + collapse.id);
            if (savedState === 'open') {
                const bsCollapse = new bootstrap.Collapse(collapse, {show: true});
            }
        });
    });
    
    // Enhanced print function
    function printPage() {
        // Add print header
        addPrintHeader();
        
        // Optimize tables for printing
        optimizeTablesForPrint();
        
        // Print
        window.print();
        
        // Remove print header after printing
        setTimeout(() => {
            removePrintHeader();
            restoreTablesAfterPrint();
        }, 1000);
    }
    
    function addPrintHeader() {
        // Check for existing print header
        const existingHeader = document.querySelector('.print-header-added');
        if (existingHeader) {
            existingHeader.remove();
        }
        
        // Create print header
        const printHeader = document.createElement('div');
        printHeader.className = 'print-header-added';
        printHeader.style.display = 'none';
        
        const currentDate = new Date();
        const dateStr = currentDate.toLocaleDateString('ar-SA', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });
        
    const pageTitle = document.querySelector('h1, h2, h3, h4, .card-title, .page-title')?.textContent?.trim() || 'التقرير';
        
    const printDateLabel = 'تاريخ الطباعة:';
        printHeader.innerHTML = `
            <div class="print-company-info">
                Finspilot - النظام المحاسبي
            </div>
            <div class="print-header">
                ${pageTitle}
            </div>
            <div class="print-date">
                ${printDateLabel} ${dateStr}
            </div>
            <style>
                @media print {
                    .print-header-added {
                        display: block !important;
                    }
                }
            </style>
        `;
        
        // Insert header at beginning of main content
        const mainContent = document.querySelector('.main-content, #main-content, .card-body, .container-fluid');
        if (mainContent) {
            mainContent.insertBefore(printHeader, mainContent.firstChild);
        }
    }
    
    function removePrintHeader() {
        const printHeader = document.querySelector('.print-header-added');
        if (printHeader) {
            printHeader.remove();
        }
    }
    
    function optimizeTablesForPrint() {
        const tables = document.querySelectorAll('.table');
        tables.forEach(table => {
            // Save original view
            table.setAttribute('data-original-width', table.style.width);
            
            // Add CSS classes for printing
            table.classList.add('print-optimized');
            
            // Optimize column display
            const headers = table.querySelectorAll('thead th');
            const rows = table.querySelectorAll('tbody tr');
            
            // Hide action columns
            headers.forEach((header, index) => {
                const headerText = header.textContent.toLowerCase();
                if (headerText.includes('actions') || headerText.includes('operations') || 
                    headerText.includes('control') || headerText.includes('procedures') ||
                    header.querySelector('.btn, button, a[href]')) {
                    header.style.display = 'none';
                    
                    // إخفاء الخلايا المقابلة في كل صف
                    rows.forEach(row => {
                        const cell = row.children[index];
                        if (cell) {
                            cell.style.display = 'none';
                        }
                    });
                }
            });
            
            // إضافة فئات CSS للبيانات رقمية
            rows.forEach(row => {
                Array.from(row.children).forEach(cell => {
                    const text = cell.textContent.trim();
                    
                    // التحقق من البيانات رقمية
                    if (/^\d+([.,]\d+)*\s*(ريال|ر\.س|SAR|$)?$/.test(text)) {
                        cell.classList.add('numeric-data');
                    }
                    
                    // التحقق من التواريخ
                    if (/\d{4}-\d{2}-\d{2}|\d{2}\/\d{2}\/\d{4}/.test(text)) {
                        cell.classList.add('date-column');
                    }
                    
                    // التحقق من الأرقام المرجعية
                    if (/^[A-Z]{2,}-\d+$/.test(text)) {
                        cell.classList.add('id-column');
                    }
                });
            });
        });
    }
    
    function restoreTablesAfterPrint() {
        const tables = document.querySelectorAll('.table.print-optimized');
        tables.forEach(table => {
            table.classList.remove('print-optimized');
            
            // استعادة العرض الأصلي
            const originalWidth = table.getAttribute('data-original-width');
            if (originalWidth) {
                table.style.width = originalWidth;
                table.removeAttribute('data-original-width');
            }
            
            // إظهار الأعمدة المخفية
            const hiddenElements = table.querySelectorAll('[style*="display: none"]');
            hiddenElements.forEach(element => {
                element.style.display = '';
            });
        });
    }
    
    // إضافة معالج للطباعة بالكيبورد (Ctrl+P)
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'p') {
            e.preventDefault();
            printPage();
        }
    });
    </script>
    
    <!-- Session Management JavaScript -->
    
    
    <script src="/static/core/js/session-manager.js?v=20251017-final"></script>
    
    
    <!-- Auto Translation JavaScript for Arabic Page -->
    
    
    <script src="/static/core/js/arabic-auto-translate.js"></script>
    
    
    <!-- Auto Translation JavaScript -->
    <script>
    if ('ar' === 'en') {
    // Auto Translation for English - Extended Dictionary
    const TRANSLATIONS = {
        // Main Navigation (Arabic to English)
        'لوحة التحكم': '',
        'تسجيل الخروج': '', 
        'الإعدادات': '',
        
        // Statistics
        'إحصائيات المبيعات': 'Sales Statistics',
        'إحصائيات المشتريات': 'Purchase Statistics',
        'إحصائيات المخزون': 'Inventory Statistics',
        'إحصائيات عامة': 'General Statistics',
        
        // Time periods
        'اليوم': 'Today',
        'هذا الشهر': 'This Month',
        'الشهر الماضي': 'Last Month',
        'هذا الربع': 'This Quarter',
        'نصف السنة': 'Half Year',
        'السنة': 'Year',
        'هذه السنة': 'This Year',
        'السنة الماضية': 'Last Year',
        'الأسبوع': 'Week',
        'هذا الأسبوع': 'This Week',
        'الأسبوع الماضي': 'Last Week',
        
        // Documents
        'فاتورة': 'Invoice',
        'فواتير': 'Invoices',
        'كشف مشتريات': 'Purchase Statement',
        'كشف مردودات المشتريات': 'Purchase Returns Statement',
        'كشف مبيعات': 'Sales Statement',
        'كشف مردودات مبيعات': 'Sales Returns Statement',
        'كشف مذكرات الدائن': 'Credit Notes Statement',
        'سند': 'Voucher',
        'سندات': 'Vouchers',
        'إيصال': 'Receipt',
        'إيصالات': 'Receipts',
        'مستند': 'Document',
        'مستندات': 'Documents',
        
        // Actions - Extended
        'إضافة': 'Add',
        'إنشاء': 'Create',
        'جديد': 'New',
        'تحرير': 'Edit',
        'تحرير': 'Edit',
        'حذف': 'Delete',
        'إزالة': 'Remove',
        'مسح': 'Delete',
        'عرض': 'View',
        'عرض التفاصيل': 'View Details',
        'التفاصيل': 'Details',
        'حفظ': 'Save',
        'حفظ التغييرات': 'Save Changes',
        'إلغاء': 'Cancel',
        'إلغاء الأمر': 'Cancel',
        'بحث': 'Search',
        'بحث': 'Search',
        'بحث متقدم': 'Advanced Search',
        'تصفية': 'Filter',
        'التصفية': 'Filter',
        'تصدير': 'Export',
        'التصدير': 'Export',
        'طباعة': 'Print',
        'الطباعة': 'Print',
        'تحديث': 'Update',
        'التحديث': 'Update',
        'تأكيد': 'Confirm',
        'التأكيد': 'Confirm',
        'رجوع': 'Back',
        'العودة': 'Back',
        'التالي': 'Next',
        'السابق': 'Previous',
        'إرسال': 'Submit',
        'تطبيق': 'Apply',
        'إعادة تعيين': 'Reset',
        'مسح الحقول': 'Clear Fields',
        'تحميل': 'Download',
        'رفع': 'Upload',
        'استيراد': 'Import',
        
        // Status
        'Status': 'Status',
        'الحالات': 'Statuses',
        'نشط': 'Active',
        'غير نشط': 'Inactive',
        'مؤكد': 'Confirmed',
        'غير مؤكد': 'Unconfirmed',
        'معلق': 'Pending',
        'ملغى': 'Cancelled',
        'مكتمل': 'Completed',
        'غير مكتمل': 'Incomplete',
        'جاري المعالجة': 'Processing',
        'مدفوع': 'Paid',
        'غير مدفوع': 'Unpaid',
        'جزئياً': 'Partial',
        'مرفوض': 'Rejected',
        'موافق عليه': 'Approved',
        'قيد المراجعة': 'Under Review',
        
        // Common Fields
        'اسم': 'Name',
        'الأسماء': 'Names',
        'اسم كامل': 'Full Name',
        'وصف': 'Description',
        'التفاصيل': 'Details',
        'Notes': 'Notes',
        'التعليقات': 'Comments',
        'عنوان': 'Address',
        'العناوين': 'Addresses',
        'هاتف': 'Phone',
        'الجوال': 'Mobile',
        'البريد الإلكتروني': 'Email',
        'موقع إلكتروني': 'Website',
        'رقم': 'Number',
        'الأرقام': 'Numbers',
        'كود': 'Code',
        'الأكواد': 'Codes',
        'رقم مرجعي': 'Reference Number',
        'رقم المرجع': 'Reference No',
        'تاريخ': 'Date',
        'التواريخ': 'Dates',
        'Creation Date': 'Creation Date',
        'تاريخ التحديث': 'Update Date',
        'وقت': 'Time',
        'الأوقات': 'Times',
        'المدة': 'Duration',
        
        // Financial Terms
        'مبلغ': 'Amount',
        'المبالغ': 'Amounts',
        'المجموع': 'Total',
        'مجموع': 'Sum',
        'الإجمالي الفرعي': 'Subtotal',
        'كمية': 'Quantity',
        'الكميات': 'Quantities',
        'سعر': 'Price',
        'الأسعار': 'Prices',
        'سعر الوحدة': 'Unit Price',
        'سعر إجمالي': 'Total Price',
        'الخصم': 'Discount',
        'الخصومات': 'Discounts',
        'نسبة الخصم': 'Discount Rate',
        'الضريبة': 'Tax',
        'الضرائب': 'Taxes',
        'نسبة الضريبة': 'Tax Rate',
        'القيمة المضافة': 'VAT',
        'المدين': 'Debit',
        'الدائن': 'Credit',
        'الرصيد': 'Balance',
        'الأرصدة': 'Balances',
        'المدفوع': 'Paid',
        'المتبقي': 'Remaining',
        'المستحق': 'Due',
        'Currency': 'Currency',
        'Currencies': 'Currencies',
        
        // Data Table Terms
        'النتائج': 'Results',
        'البيانات': 'Data',
        'القائمة': 'List',
        'القوائم': 'Lists',
        'الجدول': 'Table',
        'الجداول': 'Tables',
        'الصفحة': 'Page',
        'الصفحات': 'Pages',
        'عنصر': 'Item',
        'عناصر': 'Items',
        'سجل': 'Record',
        'سجلات': 'Records',
        'الصف': 'Row',
        'الصفوف': 'Rows',
        'العمود': 'Column',
        'الأعمدة': 'Columns',
        'العمليات': 'Actions',
        'الخيارات': 'Options',
        'Settings': 'Settings',
        'التكوين': 'Configuration',
        
        // Messages
        'تم الحفظ بنجاح': 'Saved Successfully',
        'تم التحديث بنجاح': 'Updated Successfully',
        'تم الحذف بنجاح': 'Deleted Successfully',
        'تم الإنشاء بنجاح': 'Created Successfully',
        'تمت العملية بنجاح': 'Operation Completed Successfully',
        'حدث خطأ': 'An Error Occurred',
        'خطأ في البيانات': 'Data Error',
        'خطأ في النظام': 'System Error',
        'لا توجد نتائج': 'No Results Found',
        'لا توجد بيانات': 'No Data Available',
        'البيانات فارغة': 'No Data',
        'تأكيد الحذف': 'Confirm Delete',
        'هل أنت متأكد من الحذف؟': 'Are you sure you want to delete?',
        'لا يمكن التراجع عن هذا الإجراء': 'This action cannot be undone',
        'تحذير': 'Warning',
        'تنبيه': 'Alert',
        'معلومات': 'Information',
        'نجح': 'Success',
        'فشل': 'Failed',
        'مطلوب': 'Required',
        'إجباري': 'Required',
        'اختياري': 'Optional',
        'يجب ملء هذا الحقل': 'This field is required',
        'صيغة غير صحيحة': 'Invalid format',
        
        // Business Terms
        'شركة': 'Company',
        'الشركة': 'Company',
        'الشركات': 'Companies',
        'عميل': 'Customer',
        'العميل': 'Customer',
        'عملاء': 'Customers',
        'العملاء': 'Customers',
        'مورد': 'Supplier',
        'المورد': 'Supplier',
        'موردون': 'Suppliers',
        'الموردون': 'Suppliers',
        'منتج': 'Product',
        'المنتج': 'Product',
        'منتجات': 'Products',
        'المنتجات': 'Products',
        'خدمة': 'Service',
        'الخدمة': 'Service',
        'خدمات': 'Services',
        'الخدمات': 'Services',
        'مشروع': 'Project',
        'المشروع': 'Project',
        'مشاريع': 'Projects',
        'المشاريع': 'Projects',
        
        // User Interface
        'تسجيل الدخول': 'تسجيل الدخول',
        'Logout': '',
        'خروج': '',
        'تسجيل': 'Register',
        'User': 'User',
        'المستخدمون': 'Users',
        'Password': 'Password',
        'كلمة السر': 'Password',
        'Username': 'Username',
        'البروفايل': 'Profile',
        'الملف الشخصي': 'Profile',
        'الصلاحيات': 'Permissions',
        'الأدوار': 'Roles',
        'مجموعة': 'Group',
        'مجموعات': 'Groups',
        
        // Common Words
        'من': 'From',
        'إلى': 'To',
        'في': 'In',
        'على': 'On',
        'عند': 'At',
        'مع': 'With',
        'بدون': 'Without',
        'كل': 'All',
        'جميع': 'All',
        'بعض': 'Some',
        'أخرى': 'Other',
        'آخر': 'Last',
        'أول': 'First',
        'ثاني': 'Second',
        'ثالث': 'Third',
        'نعم': 'Yes',
        'لا': 'No',
        'موافق': 'OK',
        'تم': 'Done',
        'انتهى': 'Finished',
        'جاهز': 'Ready',
        'متاح': 'Available',
        'غير متاح': 'Unavailable',
        'مفتوح': 'Open',
        'مغلق': 'Closed',
        'عام': 'General',
        'خاص': 'Private',
        'عمومي': 'Public',
        'داخلي': 'Internal',
        'خارجي': 'External',
        
        // Additional Business Terms
        'فرع': 'Branch',
        'الفرع': 'Branch',
        'فروع': 'Branches',
        'الفروع': 'Branches',
        'قسم': 'Department',
        'القسم': 'Department',
        'أقسام': 'Departments',
        'الأقسام': 'Departments',
        'وحدة': 'Unit',
        'الوحدة': 'Unit',
        'وحدات': 'Units',
        'الوحدات': 'Units',
        'مخزن': 'Warehouse',
        'المخزن': 'Warehouse',
        'مخازن': 'Warehouses',
        'المخازن': 'Warehouses',
        'مستودع': 'Warehouse',
        'المستودع': 'Warehouse',
        'مستودعات': 'Warehouses',
        'المستودعات': 'Warehouses',
        
        // Form Elements
        'اختر': 'Choose',
        'اختيار': 'Select',
        'اختر من القائمة': 'Select from List',
        'حدد': 'Select',
        'اختيار': 'Select',
        'اختر تاريخ': 'Choose Date',
        'أدخل': 'Enter',
        'إدخال': 'Enter',
        'اكتب': 'Type',
        'كتابة': 'Type',
        'ارفع ملف': 'Upload File',
        'رفع الملفات': 'Upload Files',
        'تحميل': 'Download',
        'تنزيل': 'Download',
        'استعراض': 'Browse',
        'تصفح': 'Browse',
        
        // Reports and Analytics
        'تقرير': 'Report',
        'التقرير': 'Report',
        'تقارير': 'Reports',
        'Reports': 'Reports',
        'إحصائية': 'Statistic',
        'الإحصائية': 'Statistic',
        'إحصائيات': 'Statistics',
        'الإحصائيات': 'Statistics',
        'تحليل': 'Analysis',
        'التحليل': 'Analysis',
        'تحليلات': 'Analytics',
        'التحليلات': 'Analytics',
        'مخطط': 'Chart',
        'الرسم البياني': 'Chart',
        'رسوم بيانية': 'Charts',
        'الرسوم البيانية': 'Charts',
        'جدول': 'Table',
        'الجدول': 'Table',
        'جداول': 'Tables',
        'الجداول': 'Tables',
        
        // Time-related Terms
        'صباحاً': 'AM',
        'مساءً': 'PM',
        'يومياً': 'Daily',
        'أسبوعياً': 'Weekly',
        'شهرياً': 'Monthly',
        'سنوياً': 'Annually',
        'فوراً': 'Immediately',
        'لاحقاً': 'Later',
        'قريباً': 'Soon',
        'بعد قليل': 'Shortly',
        'الآن': 'Now',
        'حالياً': 'Currently',
        'مؤقتاً': 'Temporarily',
        'دائماً': 'Always',
        'أبداً': 'Never',
        'أحياناً': 'Sometimes',
        
        // Additional Interface Terms
        'قائمة': 'Menu',
        'القائمة': 'Menu',
        'قوائم': 'Menus',
        'القوائم': 'Menus',
        'شريط': 'Bar',
        'الشريط': 'Bar',
        'أشرطة': 'Bars',
        'الأشرطة': 'Bars',
        'زر': 'Button',
        'الزر': 'Button',
        'أزرار': 'Buttons',
        'الأزرار': 'Buttons',
        'رابط': 'Link',
        'الرابط': 'Link',
        'روابط': 'Links',
        'الروابط': 'Links',
        'صورة': 'Image',
        'الصورة': 'Image',
        'صور': 'Images',
        'الصور': 'Images',
        'ملف': 'File',
        'الملف': 'File',
        'ملفات': 'Files',
        'الملفات': 'Files',
        'مجلد': 'Folder',
        'المجلد': 'Folder',
        'مجلدات': 'Folders',
        'المجلدات': 'Folders',
        
        // Additional Status Terms
        'جديد': 'New',
        'الجديد': 'New',
        'قديم': 'Old',
        'القديم': 'Old',
        'محدث': 'Updated',
        'المحدث': 'Updated',
        'محذوف': 'Deleted',
        'المحذوف': 'Deleted',
        'مضاف': 'Added',
        'المضاف': 'Added',
        'معدل': 'Modified',
        'المعدل': 'Modified',
        'مكرر': 'Duplicate',
        'المكرر': 'Duplicate',
        'فريد': 'Unique',
        'الفريد': 'Unique',
        'صحيح': 'Valid',
        'الصحيح': 'Valid',
        'خاطئ': 'Invalid',
        'الخاطئ': 'Invalid',
        
        // Accounting Specific Terms
        'حساب': 'Account',
        'الحساب': 'Account',
        'حسابات': 'Accounts',
        'الحسابات': 'Accounts',
        'قيد': 'Entry',
        'القيد': 'Entry',
        'قيود': 'Entries',
        'القيود': 'Entries',
        'يومية': 'Journal',
        'يومية': 'Journal',
        'دفتر': 'Book',
        'الدفتر': 'Book',
        'دفاتر': 'Books',
        'الدفاتر': 'Books',
        'سجل': 'Record',
        'السجل': 'Record',
        'سجلات': 'Records',
        'السجلات': 'Records',
        'ميزانية': 'Budget',
        'الميزانية': 'Budget',
        'ميزانيات': 'Budgets',
        'الميزانيات': 'Budgets',
        'كشف': 'Statement',
        'الكشف': 'Statement',
        'كشوف': 'Statements',
        'الكشوف': 'Statements',
        
        // More Common Arabic Words
        'مبيعات': 'Sales',
        'Sales': 'Sales',
        'مشتريات': 'Purchases', 
        'Purchases': 'Purchases',
        'مخزون': 'Inventory',
        'المخزون': 'Inventory',
        'إيرادات': 'Revenues',
        'الإيرادات': 'Revenues',
        'مصروفات': 'Expenses',
        'المصروفات': 'Expenses',
        'أصول': 'Assets',
        'الأصول': 'Assets',
        'خصوم': 'Liabilities',
        'الخصوم': 'Liabilities',
        'Global Search': 'البحث العام',
        'Bank Accounts': 'الحسابات البنكية',
        'الصناديق': 'Cashboxes',
        'Payment Receipts': 'Payment Receipts',
        'سندات الدفع': 'Payment Vouchers',
        'Categories & Products': 'Categories & Products',
        'Customers & Suppliers': 'Customers & Suppliers',
        'القيود المحاسبية': 'Journal Entries',
        'Assets & Liabilities': 'Assets & Liabilities',
        'Revenues & Expenses': 'Revenues & Expenses',
        'إدارة السوبر أدمين': 'إدارة السوبر أدمين',
        'إدارة النظام': 'System Management',
        'متقدم': 'Advanced',
        'المجموعات والصلاحيات': 'Groups & Permissions',
        'سجل الأنشطة': 'Activity Log',
        'إدارة أرقام المستندات': 'Document Numbers Management',
        'إعدادات النظام': 'System Settings',
        'إعدادات': '',
        'تسجيل الخروج': '',
        'اختر اللغة': 'Choose Language',
        'التنبيهات': 'Notifications',
        'الملف الشخصي': 'Profile',
        'ادارة المستخدمين': 'User Management',
        'المستخدمين': 'Users',
        'اضافة مستخدم': 'Add User',
        'تحرير مستخدم': 'Edit User',
        'حذف مستخدم': 'Delete User',
        
        // Navigation Terms
        'لوحة القيادة': '',
        'العودة للرئيسية': 'Back to Home',
        'اتصل بنا': 'Contact Us',
        'عن الشركة': 'About Company',
        'سياسة الخصوصية': 'Privacy Policy',
        'الشروط والأحكام': 'Terms & Conditions',
        
        // Action Buttons
        'تحديث البيانات': 'Update Data',
        'إعادة تحميل': 'Reload',
        'تراجع': 'Undo',
        'إعادة': 'Redo',
        'نسخ': 'Copy',
        'لصق': 'Paste',
        'قص': 'Cut',
        
        // Form Labels
        'اسم المستخدم': 'Username',
        'كلمة المرور': 'Password',
        'البريد الالكتروني': 'Email',
        'رقم الهاتف': 'Phone Number',
        'العنوان الالكامل': 'Full Address',
        'تاريخ الميلاد': 'Date of Birth',
        'الجنسية': 'Nationality',
        'المدينة': 'City',
        'البلد': 'Country',
        'الرمز البريدي': 'Postal Code',
        'نوع الحساب': 'Account Type',
        'Account Number': 'Account Number',
        'Bank Name': 'Bank Name',
        'فرع البنك': 'Bank Branch',
        
        // Status Messages
        'تم الحفظ': 'Saved',
        'تم التعديل': 'Modified',
        'تم الحذف': 'Deleted',
        'تم الإنشاء': 'Created',
        'تم التحديث': 'Updated',
        'تم الإرسال': 'Sent',
        'تم الاستلام': 'Received',
        'تم التأكيد': 'Confirmed',
        'تم الإلغاء': 'Cancelled',
        'في الانتظار': 'Pending',
        'قيد المراجعة': 'Under Review',
        'مرفوض': 'Rejected',
        'مقبول': 'Accepted',
        'موافق عليه': 'Approved',
        
        // Error Messages
        'خطأ في النظام': 'System Error',
        'خطأ في قاعدة البيانات': 'Database Error',
        'خطأ في الاتصال': 'Connection Error',
        'بيانات غير صحيحة': 'Invalid Data',
        'حقل مطلوب': 'Required Field',
        'تم تجاوز الحد المسموح': 'Limit Exceeded',
        'غير مصرح': 'Unauthorized',
        'منتهي الصلاحية': 'Expired',
        'غير موجود': 'Not Found',
        'غير متاح': 'Not Available',
        
        // Financial Terms
        'ريال سعودي': 'Saudi Riyal',
        'ريال': 'Riyal',
        'ر.س': 'SAR',
        'جنيه مصري': 'Egyptian Pound',
        'دولار أمريكي': 'US Dollar',
        'يورو': 'Euro',
        'دينار كويتي': 'Kuwaiti Dinar',
        'درهم إماراتي': 'UAE Dirham',
        'قرش': 'Piaster',
        'هللة': 'Halalah',
        
        // Additional Common Words and Phrases
        'صفحة': 'Page',
        'الصفحة': 'Page',
        'صفحات': 'Pages',
        'الصفحات': 'Pages',
        'نافذة': 'Window',
        'النافذة': 'Window',
        'نوافذ': 'Windows',
        'النوافذ': 'Windows',
        'حقل': 'Field',
        'الحقل': 'Field',
        'حقول': 'Fields',
        'الحقول': 'Fields',
        'استمارة': 'Form',
        'الاستمارة': 'Form',
        'استمارات': 'Forms',
        'الاستمارات': 'Forms',
        'نموذج': 'Form',
        'النموذج': 'Form',
        'نماذج': 'Forms',
        'النماذج': 'Forms',
        
        // Database and System Terms
        'قاعدة البيانات': 'Database',
        'قاعدة بيانات': 'Database',
        'قواعد البيانات': 'Databases',
        'قواعد بيانات': 'Databases',
        'خادم': 'Server',
        'الخادم': 'Server',
        'خوادم': 'Servers',
        'الخوادم': 'Servers',
        'شبكة': 'Network',
        'الشبكة': 'Network',
        'شبكات': 'Networks',
        'الشبكات': 'Networks',
        'اتصال': 'Connection',
        'الاتصال': 'Connection',
        'اتصالات': 'Connections',
        'الاتصالات': 'Connections',
        
        // Action Words
        'تشغيل': 'Run',
        'التشغيل': 'Run',
        'إيقاف': 'Stop',
        'الإيقاف': 'Stop',
        'بدء': 'Start',
        'البدء': 'Start',
        'انتهاء': 'End',
        'الانتهاء': 'End',
        'استكمال': 'Complete',
        'الاستكمال': 'Complete',
        'متابعة': 'Continue',
        'المتابعة': 'Continue',
        'توقف': 'Pause',
        'التوقف': 'Pause',
        'استئناف': 'Resume',
        'الاستئناف': 'Resume',
        
        // UI Elements
        'شاشة': 'Screen',
        'الشاشة': 'Screen',
        'شاشات': 'Screens',
        'الشاشات': 'Screens',
        'رمز': 'Icon',
        'الرمز': 'Icon',
        'رموز': 'Icons',
        'الرموز': 'Icons',
        'علامة': 'Mark',
        'العلامة': 'Mark',
        'علامات': 'Marks',
        'العلامات': 'Marks',
        'إشارة': 'Sign',
        'الإشارة': 'Sign',
        'إشارات': 'Signs',
        'الإشارات': 'Signs',
        
        // Content Management
        'محتوى': 'Content',
        'المحتوى': 'Content',
        'محتويات': 'Contents',
        'المحتويات': 'Contents',
        'نص': 'Text',
        'النص': 'Text',
        'نصوص': 'Texts',
        'النصوص': 'Texts',
        'كلمة': 'Word',
        'الكلمة': 'Word',
        'كلمات': 'Words',
        'الكلمات': 'Words',
        'جملة': 'Sentence',
        'الجملة': 'Sentence',
        'جمل': 'Sentences',
        'الجمل': 'Sentences',
        'فقرة': 'Paragraph',
        'الفقرة': 'Paragraph',
        'فقرات': 'Paragraphs',
        'الفقرات': 'Paragraphs',
        
        // More Business Terms
        'إدارة': 'Management',
        'الإدارة': 'Management',
        'مدير': 'Manager',
        'المدير': 'Manager',
        'مديرون': 'Managers',
        'المديرون': 'Managers',
        'موظف': 'Employee',
        'الموظف': 'Employee',
        'موظفون': 'Employees',
        'الموظفون': 'Employees',
        'عامل': 'Worker',
        'العامل': 'Worker',
        'عمال': 'Workers',
        'العمال': 'Workers',
        'فريق': 'Team',
        'الفريق': 'Team',
        'فرق': 'Teams',
        'الفرق': 'Teams',
        
        // More Financial Terms
        'دفعةة': 'Payment',
        'الدفعةة': 'Payment',
        'دفعةات': 'Payments',
        'الدفعةات': 'Payments',
        'قسط': 'Installment',
        'القسط': 'Installment',
        'أقساط': 'Installments',
        'الأقساط': 'Installments',
        'فائدة': 'Interest',
        'الفائدة': 'Interest',
        'فوائد': 'Interests',
        'الفوائد': 'Interests',
        'عمولة': 'Commission',
        'العمولة': 'Commission',
        'عمولات': 'Commissions',
        'العمولات': 'Commissions',
        'رسوم': 'Fees',
        'الرسوم': 'Fees',
        'رسم': 'Fee',
        'الرسم': 'Fee',
        
        // Transaction Terms
        'معاملة': 'Transaction',
        'المعاملة': 'Transaction',
        'معاملات': 'Transactions',
        'المعاملات': 'Transactions',
        'عملية': 'Operation',
        'العملية': 'Operation',
        'عمليات': 'Operations',
        'العمليات': 'Operations',
        'إجراء': 'Procedure',
        'الإجراء': 'Procedure',
        'إجراءات': 'Procedures',
        'الإجراءات': 'Procedures',
        'خطوة': 'Step',
        'الخطوة': 'Step',
        'خطوات': 'Steps',
        'الخطوات': 'Steps',
        
        // Time and Date Terms
        'يوم': 'Day',
        'اليوم': 'Day',
        'أيام': 'Days',
        'الأيام': 'Days',
        'شهر': 'Month',
        'الشهر': 'Month',
        'أشهر': 'Months',
        'الأشهر': 'Months',
        'سنة': 'Year',
        'السنة': 'Year',
        'سنوات': 'Years',
        'السنوات': 'Years',
        'ساعة': 'Hour',
        'الساعة': 'Hour',
        'ساعات': 'Hours',
        'الساعات': 'Hours',
        'دقيقة': 'Minute',
        'الدقيقة': 'Minute',
        'دقائق': 'Minutes',
        'الدقائق': 'Minutes',
        'ثانية': 'Second',
        'ثانيةة': 'Second',
        'ثوان': 'Seconds',
        'الثوان': 'Seconds',
        
        // Colors
        'أحمر': 'Red',
        'أخضر': 'Green',
        'أزرق': 'Blue',
        'أصفر': 'Yellow',
        'أسود': 'Black',
        'أبيض': 'White',
        'رمادي': 'Gray',
        'بني': 'Brown',
        'برتقالي': 'Orange',
        'بنفسجي': 'Purple',
        'وردي': 'Pink',
        
        // Directions
        'يمين': 'Right',
        'يسار': 'Left',
        'أعلى': 'Top',
        'أسفل': 'Bottom',
        'وسط': 'Center',
        'شمال': 'North',
        'جنوب': 'South',
        'شرق': 'East',
        'غرب': 'West',
        
        // More Common Verbs
        'يفتح': 'Opens',
        'يغلق': 'Closes',
        'يظهر': 'Shows',
        'يخفي': 'Hides',
        'يرسل': 'Sends',
        'يستقبل': 'Receives',
        'يقرأ': 'Reads',
        'يكتب': 'Writes',
        'يطبع': 'Prints',
        'يحمل': 'Loads',
        'يحفظ': 'Saves',
        'يحذف': 'Deletes',
        'يعدل': 'Edits',
        'ينشئ': 'Creates',
        'يضيف': 'Adds',
        'يزيل': 'Removes',
        'يبحث': 'Searches',
        'يجد': 'Finds',
        'يختار': 'Selects',
        'يحدد': 'Specifies',
        
        // Technical Terms
        'تطبيق': 'Application',
        'التطبيق': 'Application',
        'تطبيقات': 'Applications',
        'التطبيقات': 'Applications',
        'برنامج': 'Program',
        'البرنامج': 'Program',
        'برامج': 'Programs',
        'البرامج': 'Programs',
        'نظام': 'System',
        'النظام': 'System',
        'أنظمة': 'Systems',
        'الأنظمة': 'Systems',
        'تقنية': 'Technology',
        'التقنية': 'Technology',
        'تقنيات': 'Technologies',
        'التقنيات': 'Technologies',
        
        // Missing translations for remaining 20 texts (English to Arabic in this section)
        'System Management - For Super Admin and Admin': 'إدارة النظام - للمدير العام والمدير',
        'System Management': 'إدارة النظام',
        'Purchases': 'المشتريات',
        'Assets & Liabilities': 'الأصول والخصوم',
        'Backup and Restore': 'النسخ الاحتياطي والاستعادة',
        'Journal Entries': 'القيود المحاسبية',
        'Human Resources': 'الموارد البشرية',
        'Customers & Suppliers': 'العملاء والموردين',
        'Cashboxes': 'الصناديق',
        'Payment Vouchers': 'سندات الدفع',
        'JoFotara Settings': 'إعدادات جوفوترة',
        'Bank Accounts (visible if group grants view or edit banks account)': 'الحسابات البنكية (مرئية إذا كانت المجموعة تمنح عرض أو تعديل حساب البنوك)',
        'Inventory': 'المخزون',
        'Reports': 'التقارير',
        'Print Design Settings': 'إعدادات تصميم الطباعة',
        'Products & Categories': 'المنتجات والفئات',
        'Revenues & Expenses': 'الإيرادات والمصروفات',
        'Dashboard': 'لوحة القيادة',
        'Payment Receipts': 'إيصالات الدفع',
        'Sales': 'المبيعات',
    
            "Auto Translation JavaScript": "جافا سكريبت الترجمة التلقائية",
            "Backup and Restore": "النسخ الاحتياطي والاستعادة",
            "Bank Accounts (visible if group grants view or edit banks account)": "حسابات البنوك (مرئية إذا كانت المجموعة تمنح عرض أو تحرير حساب البنوك)",
            "Cashboxes": "الصناديق",
            "Customers & Suppliers": "العملاء والموردين",
            "Dashboard": "لوحة التحكم",
            "Enter at least two characters to start searching": "أدخل حرفين على الأقل لبدء البحث",
            "Font Awesome": "خط أويسوم",
            "Human Resources": "الموارد البشرية",
            "Inventory": "المخزون",
            "JoFotara Settings": "إعدادات جو فاتورة",
            "Journal Entries": "قيود اليومية",
            "Language Selector": "محدد اللغة",
            "Language Switching Enhancement": "تحسين تبديل اللغة",
            "Loading": "جاري التحميل",
            "Logout": "تسجيل الخروج",
            "Main Content": "المحتوى الرئيسي",
            "Notifications": "الإشعارات",
            "Payment Receipts": "إيصالات الدفع",
            "Payment Vouchers": "سندات الدفع",
            "Placeholder: Search in all documents and data...": "العنصر النائب: ابحث في جميع المستندات والبيانات...",
            "Print Design Settings": "إعدادات تصميم الطباعة",
            "Products & Categories": "المنتجات والفئات",
            "Purchases": "المشتريات",
            "Reports": "التقارير",
            "Responsive JavaScript": "جافا سكريبت متجاوب",
            "Results are sorted by newest date first": "النتائج مرتبة حسب التاريخ الأحدث أولاً",
            "Revenues & Expenses": "الإيرادات والمصروفات",
            "Sales": "المبيعات",
            "Search Field": "حقل البحث",
            "Search Tips": "نصائح البحث",
            "Search Tips:": "نصائح البحث:",
            "Search includes all documents: invoices, receipts, entries, customers, products": "البحث يشمل جميع المستندات: الفواتير، الإيصالات، القيود، العملاء، المنتجات",
            "Session Management JavaScript": "جافا سكريبت إدارة الجلسة",
            "Session settings for JavaScript": "إعدادات الجلسة لجافا سكريبت",
            "Sidebar": "الشريط الجانبي",
            "Statistics ابحث": "الإحصائيات",
            "Super Administrator": "مدير النظام الأعلى",
            "SweetAlert2": "تنبيه حلو 2",
            "System Management": "إدارة النظام",
            "System Management - For Super Admin and Admin": "إدارة النظام - للمدير الأعلى والمدير",
            "Top Navigation": "التنقل العلوي",
            "User Menu": "قائمة المستخدم",
            "You can search using invoice number, customer name, or any part of the data": "يمكنك البحث باستخدام رقم الفاتورة أو اسم العميل أو أي جزء من البيانات",
            "jQuery": "جيه كويري",
        
            "HR Dashboard": "لوحة تحكم الموارد البشرية",
            "Active Employees": "الموظفون النشطون",
            "Quick Actions": "الإجراءات السريعة",
            "Add Employee": "إضافة موظف",
            "Mark Attendance": "تسجيل الحضور",
            "Request Leave": "طلب إجازة",
            "New Payroll": "كشف رواتب جديد",
            "Today's Attendance": "حضور اليوم",
            "Present": "حاضر",
            "Absent": "غائب",
            "Late": "متأخر",
            "View All Attendance": "عرض جميع سجلات الحضور",
            "Recent Leave Requests": "طلبات الإجازة الأخيرة",
            "Employee": "الموظف",
            "Leave Type": "نوع الإجازة",
            "Duration": "المدة",
            "Status": "الحالة",
            "Actions": "الإجراءات",
            "Pending": "في الانتظار",
            "This Month": "هذا الشهر",
            "Birthdays": "أعياد الميلاد",
            "New Hires": "التعيينات الجديدة",
            "Quick Links": "روابط سريعة",
            "Employee Directory": "دليل الموظفين",
            "Departments": "الأقسام",
            "HR Reports": "تقارير الموارد البشرية",
            "Upload Attendance": "رفع بيانات الحضور",
            "Present today": "حاضر اليوم",
            "new this month": "جديد هذا الشهر",
            "Active departments": "الأقسام النشطة",
            "Manage employees, attendance, payroll, and HR operations": "إدارة الموظفين والحضور وكشوف الرواتب وعمليات الموارد البشرية",
            "View All Leave Requests": "عرض جميع طلبات الإجازة",
        };
    }
    
    // If TRANSLATIONS is not defined (for Arabic), define empty object
    if (typeof TRANSLATIONS === 'undefined') {
        var TRANSLATIONS = {};
    }
    
    // Enhanced Ultra-Comprehensive Translation System
    function translateText(text) {
        if (!text || typeof text !== 'string') return text;
        
        let translatedText = text.trim();
        
        // Direct translation first
        if (TRANSLATIONS[translatedText]) {
            return TRANSLATIONS[translatedText];
        }
        
        // Enhanced word-by-word translation for mixed content
        const words = translatedText.split(/\s+/);
        let hasTranslation = false;
        
        const translatedWords = words.map(word => {
            // Clean the word from punctuation for translation
            const cleanWord = word.replace(/[،؛:.!?()[\]{}"""''`~@#$%^&*+=<>]/g, '');
            
            // Check if cleaned word exists in translations
            if (TRANSLATIONS[cleanWord]) {
                hasTranslation = true;
                return word.replace(cleanWord, TRANSLATIONS[cleanWord]);
            }
            
            // Check for variations with "ال" prefix
            if (cleanWord.startsWith('ال') && cleanWord.length > 2) {
                const withoutAl = cleanWord.substring(2);
                if (TRANSLATIONS[withoutAl]) {
                    hasTranslation = true;
                    return word.replace(cleanWord, 'The ' + TRANSLATIONS[withoutAl]);
                }
                if (TRANSLATIONS['ال' + withoutAl]) {
                    hasTranslation = true;
                    return word.replace(cleanWord, TRANSLATIONS['ال' + withoutAl]);
                }
            }
            
            // Check for plurals ending with "ات", "ون", "ين"
            if (cleanWord.endsWith('ات') && cleanWord.length > 3) {
                const singular = cleanWord.substring(0, cleanWord.length - 2);
                if (TRANSLATIONS[singular]) {
                    hasTranslation = true;
                    return word.replace(cleanWord, TRANSLATIONS[singular] + 's');
                }
            }
            
            if (cleanWord.endsWith('ون') && cleanWord.length > 3) {
                const singular = cleanWord.substring(0, cleanWord.length - 2);
                if (TRANSLATIONS[singular]) {
                    hasTranslation = true;
                    return word.replace(cleanWord, TRANSLATIONS[singular] + 's');
                }
            }
            
            if (cleanWord.endsWith('ين') && cleanWord.length > 3) {
                const singular = cleanWord.substring(0, cleanWord.length - 2);
                if (TRANSLATIONS[singular]) {
                    hasTranslation = true;
                    return word.replace(cleanWord, TRANSLATIONS[singular] + 's');
                }
            }
            
            return word;
        });
        
        if (hasTranslation) {
            translatedText = translatedWords.join(' ');
        }
        
        // Enhanced partial translations - check all possible substrings
        const sortedKeys = Object.keys(TRANSLATIONS).sort((a, b) => b.length - a.length);
        sortedKeys.forEach(arabicText => {
            if (translatedText.includes(arabicText)) {
                const regex = new RegExp(arabicText.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
                translatedText = translatedText.replace(regex, TRANSLATIONS[arabicText]);
            }
        });
        
        return translatedText;
    }
    
    function translatePage() {
        try {
            // Ultra-comprehensive translation approach
            
            // Phase 1: TreeWalker for all text nodes
            const walker = document.createTreeWalker(
                document.body,
                NodeFilter.SHOW_TEXT,
                {
                    acceptNode: function(node) {
                        // Skip script, style, and other non-visible elements
                        const parent = node.parentElement;
                        if (!parent || ['SCRIPT', 'STYLE', 'NOSCRIPT', 'META', 'LINK'].includes(parent.tagName)) {
                            return NodeFilter.FILTER_REJECT;
                        }
                        
                        const text = node.textContent.trim();
                        if (text && /[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/.test(text)) {
                            return NodeFilter.FILTER_ACCEPT;
                        }
                        return NodeFilter.FILTER_REJECT;
                    }
                }
            );
            
            let textNode;
            const textNodes = [];
            while (textNode = walker.nextNode()) {
                textNodes.push(textNode);
            }
            
            // Translate all collected text nodes
            textNodes.forEach(node => {
                const originalText = node.textContent.trim();
                if (originalText) {
                    const translatedText = translateText(originalText);
                    if (translatedText !== originalText) {
                        node.textContent = translatedText;
                    }
                }
            });
            
            // Phase 2: Element-based translation for specific selectors
            const selectors = [
                'h1', 'h2', 'h3', 'h4', 'h5', 'h6',
                'p', 'span', 'div', 'a', 'button', 'label',
                'th', 'td', 'li', 'option', 'legend',
                '.nav-link', '.btn', '.form-label', '.card-title', '.card-text',
                '.alert', '.badge', '.breadcrumb-item', '.dropdown-item',
                '.nav-item', '.sidebar-nav-item', '.navbar-nav a'
            ];
            
            selectors.forEach(selector => {
                document.querySelectorAll(selector).forEach(element => {
                    if (element.textContent && /[\u0600-\u06FF]/.test(element.textContent)) {
                        // Only translate if element contains only text (no nested elements with different content)
                        if (element.children.length === 0 || 
                            (element.children.length === 1 && element.children[0].tagName === 'I' && element.children[0].classList.contains('fas'))) {
                            const originalText = element.textContent.trim();
                            const translatedText = translateText(originalText);
                            if (translatedText !== originalText) {
                                if (element.children.length === 1 && element.children[0].tagName === 'I') {
                                    // Preserve icon and translate only text
                                    const icon = element.children[0].outerHTML;
                                    element.innerHTML = icon + ' ' + translatedText.replace(originalText.trim(), '').trim();
                                } else {
                                    element.textContent = translatedText;
                                }
                            }
                        }
                    }
                });
            });
            
            // Phase 3: Attribute translation
            const attributesToTranslate = [
                'placeholder', 'title', 'alt', 'data-original-title', 
                'aria-label', 'data-bs-title', 'data-bs-original-title',
                'value', 'label', 'aria-labelledby'
            ];
            
            attributesToTranslate.forEach(attr => {
                document.querySelectorAll(`[${attr}]`).forEach(element => {
                    const originalValue = element.getAttribute(attr);
                    if (originalValue && originalValue.trim() && /[\u0600-\u06FF]/.test(originalValue)) {
                        const translatedValue = translateText(originalValue.trim());
                        if (translatedValue !== originalValue.trim()) {
                            element.setAttribute(attr, translatedValue);
                        }
                    }
                });
            });
            
            // Phase 4: Input values and option texts
            document.querySelectorAll('input[type="text"], input[type="search"], textarea').forEach(input => {
                if (input.value && /[\u0600-\u06FF]/.test(input.value)) {
                    const translatedValue = translateText(input.value);
                    if (translatedValue !== input.value) {
                        input.value = translatedValue;
                    }
                }
            });
            
            // Phase 5: Special Bootstrap components
            document.querySelectorAll('.dropdown-menu .dropdown-item').forEach(item => {
                if (item.textContent && /[\u0600-\u06FF]/.test(item.textContent)) {
                    const originalText = item.textContent.trim();
                    const translatedText = translateText(originalText);
                    if (translatedText !== originalText) {
                        item.textContent = translatedText;
                    }
                }
            });
            
            // Phase 6: Table content
            document.querySelectorAll('table').forEach(table => {
                table.querySelectorAll('th, td').forEach(cell => {
                    if (cell.textContent && /[\u0600-\u06FF]/.test(cell.textContent) && cell.children.length === 0) {
                        const originalText = cell.textContent.trim();
                        const translatedText = translateText(originalText);
                        if (translatedText !== originalText) {
                            cell.textContent = translatedText;
                        }
                    }
                });
            });
            
            // Phase 7: Form elements
            document.querySelectorAll('form').forEach(form => {
                form.querySelectorAll('label, legend, .form-text, .help-text').forEach(element => {
                    if (element.textContent && /[\u0600-\u06FF]/.test(element.textContent)) {
                        const originalText = element.textContent.trim();
                        const translatedText = translateText(originalText);
                        if (translatedText !== originalText) {
                            element.textContent = translatedText;
                        }
                    }
                });
            });
            
        } catch (error) {
            console.log('Translation error:', error);
        }
    }
    
    // Ultra-Advanced Translation Execution System
    document.addEventListener('DOMContentLoaded', function() {
        // Initial translations with increasing delays
        setTimeout(translatePage, 100);   // Very early
        setTimeout(translatePage, 300);   // Early
        setTimeout(translatePage, 600);   // Medium
        setTimeout(translatePage, 1000);  // Late
        setTimeout(translatePage, 2000);  // Very late
        
        // Force translation of special forms and tables
        setTimeout(translateFormsAndTables, 500);
        setTimeout(translateFormsAndTables, 1200);
        setTimeout(translateFormsAndTables, 2500);
        
        // Ultimate force translation
        setTimeout(forceTranslateAll, 3000);
        setTimeout(forceTranslateAll, 5000);
        
        // Continuous translation every 3 seconds
        setInterval(function() {
            if (document.documentElement.lang === 'en') {
                translatePage();
            }
        }, 3000);
        
        // Also run translation when page becomes visible (tab focus)
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden && document.documentElement.lang === 'en') {
                setTimeout(translatePage, 100);
                setTimeout(translateFormsAndTables, 200);
            }
        });
        
        // Translation on scroll (for lazy-loaded content)
        let scrollTimeout;
        window.addEventListener('scroll', function() {
            if (document.documentElement.lang === 'en') {
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(translatePage, 500);
            }
        });
        
        // Translation on resize (for responsive content)
        let resizeTimeout;
        window.addEventListener('resize', function() {
            if (document.documentElement.lang === 'en') {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(translatePage, 300);
            }
        });
    });
    
    // Advanced Dynamic Content Observer
    const observer = new MutationObserver(function(mutations) {
        let needsTranslation = false;
        
        mutations.forEach(function(mutation) {
            if (mutation.type === 'childList') {
                // Check added nodes
                mutation.addedNodes.forEach(function(node) {
                    if (node.nodeType === Node.ELEMENT_NODE) {
                        // Check if the added element contains Arabic text
                        if (node.textContent && /[\u0600-\u06FF]/.test(node.textContent)) {
                            needsTranslation = true;
                        }
                    } else if (node.nodeType === Node.TEXT_NODE) {
                        // Check if the added text node is Arabic
                        if (node.textContent && /[\u0600-\u06FF]/.test(node.textContent)) {
                            needsTranslation = true;
                        }
                    }
                });
            } else if (mutation.type === 'characterData') {
                // Check modified text content
                if (mutation.target.textContent && /[\u0600-\u06FF]/.test(mutation.target.textContent)) {
                    needsTranslation = true;
                }
            } else if (mutation.type === 'attributes') {
                // Check modified attributes
                const element = mutation.target;
                const attributeName = mutation.attributeName;
                if (['placeholder', 'title', 'alt', 'aria-label', 'data-bs-title'].includes(attributeName)) {
                    const attributeValue = element.getAttribute(attributeName);
                    if (attributeValue && /[\u0600-\u06FF]/.test(attributeValue)) {
                        needsTranslation = true;
                    }
                }
            }
        });
        
        if (needsTranslation && document.documentElement.lang === 'en') {
            // Immediate translation for critical content
            setTimeout(translatePage, 50);
            // Follow-up translation to catch any missed content
            setTimeout(translatePage, 300);
            setTimeout(translateFormsAndTables, 400);
        }
    });
    
    // Start observing the document with comprehensive options
    observer.observe(document.body, {
        childList: true,
        subtree: true,
        characterData: true,
        attributes: true,
        attributeFilter: ['placeholder', 'title', 'alt', 'aria-label', 'data-bs-title', 'value', 'textContent']
    });
    
    // Comprehensive Event-Based Translation System
    
    // Translation on various user interactions
    ['click', 'focus', 'blur', 'change', 'input', 'keyup', 'mouseenter', 'mouseleave'].forEach(eventType => {
        document.addEventListener(eventType, function(e) {
            if (document.documentElement.lang === 'en') {
                // Delayed translation to allow for content updates
                setTimeout(translatePage, 100);
            }
        });
    });
    
    // Special handling for form submissions and AJAX calls
    const originalFetch = window.fetch;
    window.fetch = function(...args) {
        return originalFetch.apply(this, args).then(response => {
            if (document.documentElement.lang === 'en') {
                // Translate after AJAX content is loaded
                setTimeout(translatePage, 200);
                setTimeout(translateFormsAndTables, 400);
            }
            return response;
        });
    };
    
    // Override XMLHttpRequest for older AJAX calls
    const originalXHROpen = XMLHttpRequest.prototype.open;
    XMLHttpRequest.prototype.open = function() {
        this.addEventListener('load', function() {
            if (document.documentElement.lang === 'en') {
                setTimeout(translatePage, 150);
                setTimeout(translateFormsAndTables, 300);
            }
        });
        return originalXHROpen.apply(this, arguments);
    };
    
    // Translation on hash change and popstate
    window.addEventListener('hashchange', function() {
        if (document.documentElement.lang === 'en') {
            setTimeout(translatePage, 200);
        }
    });
    
    window.addEventListener('popstate', function() {
        if (document.documentElement.lang === 'en') {
            setTimeout(translatePage, 300);
        }
    });
    
    // Translation when Bootstrap components are shown
    document.addEventListener('shown.bs.modal', function() {
        if (document.documentElement.lang === 'en') {
            setTimeout(translatePage, 100);
        }
    });
    
    document.addEventListener('shown.bs.collapse', function() {
        if (document.documentElement.lang === 'en') {
            setTimeout(translatePage, 100);
        }
    });
    
    document.addEventListener('shown.bs.dropdown', function() {
        if (document.documentElement.lang === 'en') {
            setTimeout(translatePage, 50);
        }
    });
    
    document.addEventListener('shown.bs.tab', function() {
        if (document.documentElement.lang === 'en') {
            setTimeout(translatePage, 100);
        }
    });
    
    // Special translation for forms and tables
    function translateFormsAndTables() {
        // Translate form labels
        document.querySelectorAll('label').forEach(label => {
            if (label.textContent && /[\u0600-\u06FF]/.test(label.textContent)) {
                const originalText = label.textContent.trim();
                const translatedText = translateText(originalText);
                if (translatedText !== originalText) {
                    label.textContent = translatedText;
                }
            }
        });
        
        // Translate table headers and cells
        document.querySelectorAll('th, td').forEach(cell => {
            if (cell.textContent && /[\u0600-\u06FF]/.test(cell.textContent)) {
                const originalText = cell.textContent.trim();
                const translatedText = translateText(originalText);
                if (translatedText !== originalText) {
                    cell.textContent = translatedText;
                }
            }
        });
        
        // Translate buttons
        document.querySelectorAll('button, .btn').forEach(btn => {
            if (btn.textContent && /[\u0600-\u06FF]/.test(btn.textContent)) {
                const originalText = btn.textContent.trim();
                const translatedText = translateText(originalText);
                if (translatedText !== originalText) {
                    btn.textContent = translatedText;
                }
            }
        });
        
        // Translate navigation items specifically
        document.querySelectorAll('.nav-link, .navbar-nav a, .sidebar a').forEach(navItem => {
            if (navItem.textContent && /[\u0600-\u06FF]/.test(navItem.textContent)) {
                const originalText = navItem.textContent.trim();
                const translatedText = translateText(originalText);
                if (translatedText !== originalText) {
                    navItem.textContent = translatedText;
                }
            }
        });
        
        // Translate breadcrumb items
        document.querySelectorAll('.breadcrumb-item').forEach(breadcrumb => {
            if (breadcrumb.textContent && /[\u0600-\u06FF]/.test(breadcrumb.textContent)) {
                const originalText = breadcrumb.textContent.trim();
                const translatedText = translateText(originalText);
                if (translatedText !== originalText) {
                    breadcrumb.textContent = translatedText;
                }
            }
        });
        
        // Translate card titles and text
        document.querySelectorAll('.card-title, .card-text, .card-header').forEach(cardElement => {
            if (cardElement.textContent && /[\u0600-\u06FF]/.test(cardElement.textContent)) {
                const originalText = cardElement.textContent.trim();
                const translatedText = translateText(originalText);
                if (translatedText !== originalText) {
                    cardElement.textContent = translatedText;
                }
            }
        });
        
        // Translate alerts and messages
        document.querySelectorAll('.alert, .message').forEach(alert => {
            if (alert.textContent && /[\u0600-\u06FF]/.test(alert.textContent)) {
                const originalText = alert.textContent.trim();
                const translatedText = translateText(originalText);
                if (translatedText !== originalText) {
                    alert.textContent = translatedText;
                }
            }
        });
    }
    
    // Run special translation for forms and tables
    document.addEventListener('DOMContentLoaded', function() {
        setTimeout(translateFormsAndTables, 300);
        setTimeout(translateFormsAndTables, 600);
        setTimeout(translateFormsAndTables, 1200);
        
        // Run special translation periodically
        setInterval(function() {
            if (document.documentElement.lang === 'en') {
                translateFormsAndTables();
            }
        }, 3000);
    });
    
    // Ultimate Comprehensive Translation System - Final Version
    
    // Force translate any remaining Arabic text - ENHANCED
    function forceTranslateAll() {
        if (document.documentElement.lang !== 'en') return;
        
        try {
            // Method 1: TreeWalker for all text nodes
            const allTextNodes = document.createTreeWalker(
                document.body,
                NodeFilter.SHOW_TEXT,
                {
                    acceptNode: function(node) {
                        const parent = node.parentElement;
                        if (!parent || ['SCRIPT', 'STYLE', 'NOSCRIPT'].includes(parent.tagName)) {
                            return NodeFilter.FILTER_REJECT;
                        }
                        const text = node.textContent.trim();
                        return text && /[\u0600-\u06FF]/.test(text) ? 
                            NodeFilter.FILTER_ACCEPT : 
                            NodeFilter.FILTER_REJECT;
                    }
                }
            );
            
            let textNode;
            while (textNode = allTextNodes.nextNode()) {
                const originalText = textNode.textContent.trim();
                if (originalText) {
                    const translatedText = translateText(originalText);
                    if (translatedText !== originalText) {
                        textNode.textContent = translatedText;
                    }
                }
            }
            
            // Method 2: Query all possible elements with Arabic content
            const allElements = document.querySelectorAll('*:not(script):not(style):not(noscript)');
            allElements.forEach(element => {
                if (element.textContent && 
                    /[\u0600-\u06FF]/.test(element.textContent) && 
                    element.children.length === 0) {
                    
                    const originalText = element.textContent.trim();
                    const translatedText = translateText(originalText);
                    if (translatedText !== originalText) {
                        element.textContent = translatedText;
                    }
                }
            });
            
        } catch (error) {
            console.log('Ultimate force translation error:', error);
        }
    }
    
    // Enhanced Final Translation Function
    function finalTranslationSweep() {
        if (document.documentElement.lang !== 'en') return;
        
        // Final comprehensive sweep of all text content
        const finalSelectors = [
            'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'span', 'div', 'a', 'button', 
            'label', 'th', 'td', 'li', 'option', 'legend', 'caption', 'figcaption',
            '.nav-link', '.btn', '.form-label', '.card-title', '.card-text', '.alert',
            '.badge', '.breadcrumb-item', '.dropdown-item', '.list-group-item',
            '.tab-pane', '[data-bs-toggle]', '.modal-title', '.modal-body',
            '.toast-header', '.toast-body', '.accordion-header', '.accordion-body'
        ];
        
        finalSelectors.forEach(selector => {
            document.querySelectorAll(selector).forEach(element => {
                if (element.textContent && /[\u0600-\u06FF]/.test(element.textContent)) {
                    const hasOnlyTextOrIcon = element.children.length === 0 || 
                        (element.children.length === 1 && element.children[0].tagName === 'I' && 
                         element.children[0].classList.contains('fas'));
                        
                    if (hasOnlyTextOrIcon) {
                        const originalText = element.textContent.trim();
                        const translatedText = translateText(originalText);
                        if (translatedText !== originalText) {
                            if (element.children.length === 1 && element.children[0].tagName === 'I') {
                                const icon = element.children[0].outerHTML;
                                element.innerHTML = icon + ' ' + translatedText.replace(/^\s*/, '');
                            } else {
                                element.textContent = translatedText;
                            }
                        }
                    }
                }
            });
        });
        
        // Final attribute translation
        document.querySelectorAll('[placeholder], [title], [alt], [aria-label], [data-bs-title]').forEach(element => {
            ['placeholder', 'title', 'alt', 'aria-label', 'data-bs-title'].forEach(attr => {
                const value = element.getAttribute(attr);
                if (value && /[\u0600-\u06FF]/.test(value)) {
                    const translatedValue = translateText(value);
                    if (translatedValue !== value) {
                        element.setAttribute(attr, translatedValue);
                    }
                }
            });
        });
    }
    
    // Ultimate Translation Execution System - FIXED for Arabic Version
    document.addEventListener('DOMContentLoaded', function() {
        // CRITICAL: Only run translation in English version
        if (document.documentElement.lang !== 'en') {
            console.log('🌍 Arabic version detected - translation system disabled');
            return; // Exit immediately for Arabic version
        }
        
        console.log('🌍 English version detected - enabling translation system');
        
        // Defer translation to avoid blocking page rendering
        setTimeout(function() {
            // Initial translation with reduced frequency
            forceTranslateAll();
            finalTranslationSweep();
        }, 500);
        
        // Secondary phase - less aggressive
        setTimeout(function() {
            forceTranslateAll();
            finalTranslationSweep();
        }, 2000);
        
        // Final phase - only if needed
        setTimeout(function() {
            if (document.documentElement.lang === 'en') {
                forceTranslateAll();
                finalTranslationSweep();
                console.log('🌟 Ultimate Arabic translation completed! 🌟');
            }
        }, 5000);
        
        // Reduced monitoring frequency to improve performance
        setInterval(function() {
            if (document.documentElement.lang === 'en') {
                // Only run if there are untranslated Arabic texts
                const arabicTexts = document.querySelectorAll('*');
                let foundUntranslated = false;
                for (let i = 0; i < Math.min(arabicTexts.length, 50); i++) { // Limit check to first 50 elements
                    if (arabicTexts[i].textContent && /[\u0600-\u06FF]/.test(arabicTexts[i].textContent)) {
                        foundUntranslated = true;
                        break;
                    }
                }
                
                if (foundUntranslated) {
                    forceTranslateAll();
                    finalTranslationSweep();
                }
            }
        }, 10000); // Increased interval from 5s to 10s
    });
    </script>
    
    <!-- Responsive JavaScript -->
    <script src="/static/core/js/responsive.js"></script>
    <script src="/static/core/js/table-responsive.js"></script>
    
    <!-- Language Switching Enhancement -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // التعامل مع نماذج تبديل اللغة
        const languageForms = document.querySelectorAll('.language-form');
        languageForms.forEach(form => {
            form.addEventListener('submit', function(e) {
                // تحديد المسار الصحيح بناءً على اللغة المستهدفة
                const targetLang = this.dataset.targetLang;
                const nextField = this.querySelector('.next-field');
                const currentPath = nextField.value;
                
                // تحويل المسار إلى اللغة المستهدفة
                let newPath = currentPath;
                if (targetLang === 'ar') {
                    // التحويل إلى العربية
                    if (newPath.startsWith('/en/')) {
                        newPath = newPath.replace('/en/', '/ar/');
                    } else if (!newPath.startsWith('/ar/')) {
                        newPath = '/ar' + newPath;
                    }
                } else if (targetLang === 'en') {
                    // التحويل إلى الإنجليزية
                    if (newPath.startsWith('/ar/')) {
                        newPath = newPath.replace('/ar/', '/en/');
                    } else if (!newPath.startsWith('/en/')) {
                        newPath = '/en' + newPath;
                    }
                }
                
                // تحديث قيمة next
                nextField.value = newPath;
                
                // إضافة مؤشر تحميل
                const button = this.querySelector('button');
                const originalText = button.innerHTML;
                button.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>جاري التبديل...';
                button.disabled = true;
                
                // التأكد من إرسال النموذج
                setTimeout(() => {
                    if (button.disabled) {
                        button.innerHTML = originalText;
                        button.disabled = false;
                    }
                }, 3000);
            });
        });
    });
    
    // JavaScript لفتح القوائم المنسدلة النشطة تلقائياً
    document.addEventListener('DOMContentLoaded', function() {
        // العثور على الرابط النشط في الشريط الجانبي
        const activeLink = document.querySelector('.sidebar .nav-link.active');
        if (activeLink) {
            // إذا كان الرابط النشط له قائمة منسدلة، افتحها
            const collapseHref = activeLink.getAttribute('href');
            if (collapseHref && collapseHref.startsWith('#')) {
                const collapseElement = document.querySelector(collapseHref);
                if (collapseElement) {
                    // إضافة class 'show' لفتح القائمة
                    collapseElement.classList.add('show');
                }
            }
        }
    });
    </script>
    
    
<script>
// UPDATED: 2025-10-18 - Fixed TRANSLATIONS and auto-save
$(document).ready(function() {
    console.log('✅ صفحة تعديل الفاتورة تم تحميلها - v2.1');
    
    // CSRF token setup for AJAX
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    const csrftoken = getCookie('csrftoken');

    // Add item button click
    $('#add-item-btn').click(function() {
        $('#add-item-form').slideDown();
        $('#new-product-select').focus();
    });

    // Cancel add item
    $('#cancel-add-item-btn').click(function() {
        $('#add-item-form').slideUp();
        $('#add-item-form input, #add-item-form select').val('');
    });

    // Product selection change - استخدام POS API (بنفس طريقة POS وصفحة الإضافة)
    $('#new-product-select').change(function() {
        const productId = $(this).val();
        
        if (!productId) {
            $('#new-price').val('');
            $('#new-tax-rate').val('');
            return;
        }
        
        // عرض رسالة تحميل
        $('#new-price').val('...').prop('disabled', true);
        $('#new-tax-rate').val('...').prop('disabled', true);
        
        // استدعاء POS API للحصول على السعر الصحيح (بدون ضريبة)
        $.ajax({
            url: `/sales/pos/product/${productId}/`,
            type: 'GET',
            success: function(data) {
                $('#new-price').prop('disabled', false);
                $('#new-tax-rate').prop('disabled', false);
                
                if (data && data.success && data.product) {
                    // استخدام السعر من API (بدون ضريبة)
                    $('#new-price').val(parseFloat(data.product.price || 0).toFixed(3));
                    $('#new-tax-rate').val(parseFloat(data.product.tax_rate || 0).toFixed(2));
                    console.info('✅ السعر من POS API:', data.product.price);
                } else {
                    // في حالة فشل API، استخدام القيم من الـ template
                    const selectedOption = $('#new-product-select').find('option:selected');
                    const fallbackPrice = parseFloat(selectedOption.data('price')) || 0;
                    const fallbackTax = parseFloat(selectedOption.data('tax')) || 0;
                    const calculatedPrice = fallbackTax > 0 ? fallbackPrice / (1 + fallbackTax / 100) : fallbackPrice;
                    
                    $('#new-price').val(calculatedPrice.toFixed(3));
                    $('#new-tax-rate').val(fallbackTax.toFixed(2));
                    console.warn('⚠️ استخدام القيم الاحتياطية');
                }
            },
            error: function(xhr, status, error) {
                $('#new-price').prop('disabled', false);
                $('#new-tax-rate').prop('disabled', false);
                
                // في حالة خطأ، استخدام القيم من الـ template
                const selectedOption = $('#new-product-select').find('option:selected');
                const fallbackPrice = parseFloat(selectedOption.data('price')) || 0;
                const fallbackTax = parseFloat(selectedOption.data('tax')) || 0;
                const calculatedPrice = fallbackTax > 0 ? fallbackPrice / (1 + fallbackTax / 100) : fallbackPrice;
                
                $('#new-price').val(calculatedPrice.toFixed(3));
                $('#new-tax-rate').val(fallbackTax.toFixed(2));
                console.error('❌ خطأ في استدعاء POS API:', error);
            }
        });
    });

    // Save new item
    $('#save-new-item-btn').click(function() {
        const productId = $('#new-product-select').val();
        const quantity = parseFloat($('#new-quantity').val());
        const price = parseFloat($('#new-price').val());
        const taxRate = parseFloat($('#new-tax-rate').val());

        if (!productId || !quantity || !price || taxRate === null) {
            alert('يرجى ملء جميع الحقول');
            return;
        }

        $.ajax({
            url: `${apiBaseUrl}/items/add/`,
            type: 'POST',
            data: {
                csrfmiddlewaretoken: csrftoken,
                product_id: productId,
                quantity: quantity,
                unit_price: price,
                tax_rate: taxRate
            },
            success: function(response) {
                if (response.success) {
                    location.reload(); // Reload to show updated items
                } else {
                    alert('خطأ: ' + response.message);
                }
            },
            error: function() {
                alert('حدث خطأ أثناء إضافة المنتج');
            }
        });
    });

    // Format currency for display
    function formatCurrency(value) {
        if (typeof value === 'string') {
            value = parseFloat(value);
        }
        // Return with 3 decimal places
        return value.toFixed(3).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    // Parse number from string
    function parseNumber(str) {
        if (!str) return 0;
        if (typeof str === 'number') return str;
        // Remove any non-numeric characters except decimal point
        return parseFloat(str.toString().replace(/[^\d.-]/g, '')) || 0;
    }

    // Build the correct base URL for API calls
    const currentPath = window.location.pathname;
    // Extract the language and invoice ID
    const pathMatch = currentPath.match(/^\/([a-z]{2})\/sales\/invoices\/edit\/(\d+)\/$/);
    const language = pathMatch ? pathMatch[1] : 'ar';
    const invoiceId = '17';
    const apiBaseUrl = `/${language}/sales/invoices/${invoiceId}`;

    // Auto-save when pressing Enter in quantity or price inputs
    $('.quantity-input, .price-input').on('keypress', function(e) {
        if (e.which === 13) { // Enter key
            const row = $(this).closest('tr');
            const itemId = $(this).data('item-id');
            const btn = row.find('.edit-item-btn[data-item-id="' + itemId + '"]');
            btn.click();
        }
    });

    // Edit item buttons
    $('.edit-item-btn').click(function() {
        const itemId = $(this).data('item-id');
        const row = $(this).closest('tr');
        const quantity = row.find('.quantity-input').val();
        const price = row.find('.price-input').val();
        
        console.log(`🔍 تحديث العنصر ${itemId}: الكمية=${quantity}, السعر=${price}`);
        
        // Validate input
        if (!quantity || !price) {
            alert('يرجى إدخال الكمية وسعر الوحدة');
            return;
        }
        
        const qtyNum = parseFloat(quantity);
        const priceNum = parseFloat(price);
        
        if (qtyNum <= 0 || priceNum < 0) {
            alert('الكمية يجب أن تكون أكبر من صفر، والسعر يجب أن يكون ≥ صفر');
            return;
        }

        $(this).prop('disabled', true).html('<i class="fas fa-spinner fa-spin"></i>');

        $.ajax({
            url: `${apiBaseUrl}/items/${itemId}/update/`,
            type: 'POST',
            data: {
                csrfmiddlewaretoken: csrftoken,
                quantity: quantity,
                unit_price: price
            },
            success: function(response) {
                console.log('✅ استجابة الخادم:', response);
                
                if (response.success) {
                    // Update the item display values
                    const taxAmount = parseNumber(response.item.tax_amount);
                    const totalAmount = parseNumber(response.item.total_amount);
                    
                    row.find('.tax-amount').text(formatCurrency(taxAmount));
                    row.find('.total-amount strong').text(formatCurrency(totalAmount));
                    
                    console.log(`✅ تم تحديث صفوف الجدول - ضريبة: ${taxAmount}, إجمالي: ${totalAmount}`);
                    
                    // Update invoice totals if provided
                    if (response.invoice) {
                        const invoiceSubtotal = parseNumber(response.invoice.subtotal);
                        const invoiceTaxAmount = parseNumber(response.invoice.tax_amount);
                        const invoiceTotalAmount = parseNumber(response.invoice.total_amount);
                        const invoiceDiscountAmount = parseNumber(response.invoice.discount_amount);
                        
                        console.log(`📊 مجاميع الفاتورة الجديدة:`, response.invoice);
                        
                        // Update totals using IDs directly
                        $('#invoice-subtotal-display').text(formatCurrency(invoiceSubtotal));
                        $('#invoice-tax-display').text(formatCurrency(invoiceTaxAmount));
                        $('#invoice-discount-display').text(formatCurrency(invoiceDiscountAmount));
                        $('#invoice-total-display').text(formatCurrency(invoiceTotalAmount));
                        
                        console.log(`✅ تم تحديث المجاميع:`);
                        console.log(`  المجموع الفرعي: ${invoiceSubtotal}`);
                        console.log(`  مبلغ الضريبة: ${invoiceTaxAmount}`);
                        console.log(`  مبلغ الخصم: ${invoiceDiscountAmount}`);
                        console.log(`  الإجمالي: ${invoiceTotalAmount}`);
                    }
                    
                    // Reset button
                    $('.edit-item-btn[data-item-id="' + itemId + '"]').prop('disabled', false).html('<i class="fas fa-save"></i>');
                    
                    // Show success message
                    showMessage('✅ ' + response.message, 'success');
                    console.log('✅ تم تحديث العنصر بنجاح:', response.item);
                } else {
                    alert('❌ خطأ: ' + response.message);
                    $('.edit-item-btn[data-item-id="' + itemId + '"]').prop('disabled', false).html('<i class="fas fa-save"></i>');
                }
            },
            error: function(xhr, status, error) {
                console.error('❌ خطأ AJAX:', error, xhr);
                console.log('Status:', status);
                console.log('Response:', xhr.responseText);
                alert('❌ حدث خطأ أثناء تحديث العنصر. تحقق من الكمية والسعر.');
                $('.edit-item-btn[data-item-id="' + itemId + '"]').prop('disabled', false).html('<i class="fas fa-save"></i>');
            }
        });
    });

    // Delete item buttons
    $('.delete-item-btn').click(function() {
        if (!confirm('هل أنت متأكد من حذف هذا العنصر؟')) {
            return;
        }

        const itemId = $(this).data('item-id');

        $.ajax({
            url: `${apiBaseUrl}/items/${itemId}/delete/`,
            type: 'POST',
            data: {
                csrfmiddlewaretoken: csrftoken
            },
            success: function(response) {
                if (response.success) {
                    location.reload(); // Reload to show updated items
                } else {
                    alert('خطأ: ' + response.message);
                }
            },
            error: function() {
                alert('حدث خطأ أثناء حذف العنصر');
            }
        });
    });

    // Function to show messages
    function showMessage(message, type) {
        const alertClass = type === 'success' ? 'alert-success' : 'alert-danger';
        const alertHtml = `
            <div class="alert ${alertClass} alert-dismissible fade show" role="alert">
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        `;
        
        $('.container-fluid').prepend(alertHtml);
        
        // Auto hide after 3 seconds
        setTimeout(function() {
            $('.alert').fadeOut();
        }, 3000);
    }
});
</script>

</body>
</html>
