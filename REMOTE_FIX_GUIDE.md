# ุฏููู ุฅุตูุงุญ ุงูููุงุชูุฑ ุงูููุฏูุฉ ุนูู ุงูุฎุงุฏู ุงููุจุงุดุฑ

## ุงููุดููุฉ
ุชูุฌุฏ ููุงุชูุฑ ููุฏูุฉ ุนูู ุงูุฎุงุฏู ุงููุจุงุดุฑ ุจุฏูู ุตูุฏูู ููุฏู ูุญุฏุฏ

## ุงูุญู (ุจุฏูู ุฑูุน ููุฏ ุนูู Git)

### ุงูุทุฑููุฉ 1: ุนุจุฑ SSH (ุงูุฃุณูู ูุงูุฃุณุฑุน) โญ

#### ุงูุฎุทูุงุช:

1. **ุงูุงุชุตุงู ุจุงูุฎุงุฏู ุนุจุฑ SSH**
   ```bash
   ssh username@your-server.com
   ```

2. **ุงูุงูุชูุงู ููุฌูุฏ ุงููุดุฑูุน**
   ```bash
   cd /path/to/finspilot
   ```

3. **ุฅูุดุงุก ุงูุณูุฑูุจุช ูุจุงุดุฑุฉ ุนูู ุงูุฎุงุฏู**
   
   ุงุณุชุฎุฏู ูุญุฑุฑ ูุตูุต (nano ุฃู vim):
   ```bash
   nano fix_remote_cash_invoices.py
   ```
   
   ุซู ุงูุณุฎ ูุงูุตู ูุญุชูู ุงูููู `fix_remote_cash_invoices.py` ูู ุฌูุงุฒู ุงููุญูู

4. **ุชุดุบูู ุงูุณูุฑูุจุช**
   ```bash
   python fix_remote_cash_invoices.py
   ```
   
   ุฃู ุฅุฐุง ููุช ุชุณุชุฎุฏู virtual environment:
   ```bash
   source venv/bin/activate  # ุฃู .venv/bin/activate
   python fix_remote_cash_invoices.py
   ```

5. **ุงูุชุฃููุฏ ูุงููุชุงุจุนุฉ**
   - ุณูุนุฑุถ ุงูุณูุฑูุจุช ุนุฏุฏ ุงูููุงุชูุฑ ูุงููุจูุบ ุงูุฅุฌูุงูู
   - ุงูุชุจ "ูุนู" ููุชุฃููุฏ
   - ุณูุชู ุงูุฅุตูุงุญ ุชููุงุฆูุงู

6. **ุงูุชุญูู ูู ุงููุชูุฌุฉ**
   - ุงูุชุญ ุตูุญุฉ ุงูููุงุชูุฑ ุนูู ุงูุฎุงุฏู
   - ุชุฃูุฏ ูู ุฃู ุฌููุน ุงูููุงุชูุฑ ุงูููุฏูุฉ ูุฑุชุจุทุฉ ุจุตูุฏูู

---

### ุงูุทุฑููุฉ 2: ุนุจุฑ Django Shell (ุฅุฐุง ูู ูุชููุฑ SSH)

#### ุงูุฎุทูุงุช:

1. **ุงูุฏุฎูู ุฅูู Django Shell ุนูู ุงูุฎุงุฏู**
   ```bash
   python manage.py shell
   ```

2. **ูุณุฎ ููุตู ุงูููุฏ ุงูุชุงูู**

   ```python
   from django.db import transaction
   from sales.models import SalesInvoice
   from cashboxes.models import Cashbox
   from django.contrib.auth import get_user_model
   
   User = get_user_model()
   
   # ุงูุญุตูู ุนูู ุงูููุงุชูุฑ ุงูููุฏูุฉ ุจุฏูู ุตูุฏูู
   invoices = SalesInvoice.objects.filter(payment_type='cash', cashbox__isnull=True)
   count = invoices.count()
   total_amount = sum(invoice.total_amount for invoice in invoices)
   
   print(f"ุนุฏุฏ ุงูููุงุชูุฑ: {count}")
   print(f"ุงููุจูุบ ุงูุฅุฌูุงูู: {total_amount}")
   
   # ุงูุฅุตูุงุญ
   with transaction.atomic():
       default_user = User.objects.filter(is_active=True).first()
       
       cashbox, created = Cashbox.objects.get_or_create(
           name='ูุจูุนุงุช ููุฏูุฉ ุณุงุจูุฉ',
           defaults={
               'balance': total_amount,
               'currency': 'JOD',
               'responsible_user': default_user,
               'is_active': True,
               'description': 'ุตูุฏูู ุชุงุฑูุฎู ููููุงุชูุฑ ุงูููุฏูุฉ ุงูุณุงุจูุฉ'
           }
       )
       
       if not created:
           cashbox.balance += total_amount
           cashbox.save()
       
       updated = invoices.update(cashbox=cashbox)
       
       print(f"โ ุชู ุชุญุฏูุซ {updated} ูุงุชูุฑุฉ")
       print(f"๐ฐ ุฑุตูุฏ ุงูุตูุฏูู: {cashbox.balance}")
   ```

3. **ุงุถุบุท Enter** ูุชูููุฐ ุงูููุฏ

---

### ุงูุทุฑููุฉ 3: ุนุจุฑ ููุญุฉ ุงูุชุญูู (Render/Heroku/etc)

ุฅุฐุง ููุช ุชุณุชุฎุฏู ููุตุฉ ุงุณุชุถุงูุฉ ูุซู Render:

1. **ุงูุชุญ ููุญุฉ ุงูุชุญูู**
   - ุงูุชูู ุฅูู Dashboard โ Your App โ Shell

2. **ุดุบู Django Shell**
   ```bash
   python manage.py shell
   ```

3. **ุงุณุชุฎุฏู ููุณ ุงูููุฏ ูู ุงูุทุฑููุฉ 2**

---

### ุงูุทุฑููุฉ 4: ุฑูุน ุงูุณูุฑูุจุช ุนุจุฑ SFTP (ุจุฏูู Git)

ุฅุฐุง ูุงู ูุฏูู ูุตูู SFTP:

1. **ุงูุชุญ ุจุฑูุงูุฌ SFTP** (FileZilla, WinSCP, etc)

2. **ุงุชุตู ุจุงูุฎุงุฏู**

3. **ุงุฑูุน ุงูููู `fix_remote_cash_invoices.py`** ุฅูู ูุฌูุฏ ุงููุดุฑูุน

4. **ุดุบู ุงูุณูุฑูุจุช ุนุจุฑ SSH** ููุง ูู ุงูุทุฑููุฉ 1

---

## ุงูุชุญูู ูู ูุฌุงุญ ุงูุฅุตูุงุญ

ุจุนุฏ ุชูููุฐ ุงูุฅุตูุงุญุ ุชุญูู ูู:

1. โ **ุตูุญุฉ ุงูููุงุชูุฑ**: ุฌููุน ุงูููุงุชูุฑ ุงูููุฏูุฉ ูุฌุจ ุฃู ุชุธูุฑ ุงุณู ุงูุตูุฏูู
2. โ **ุตูุญุฉ ุงูุตูุงุฏูู**: ูุฌุจ ุฃู ูุธูุฑ ุตูุฏูู "ูุจูุนุงุช ููุฏูุฉ ุณุงุจูุฉ" ุจุฑุตูุฏ ุตุญูุญ
3. โ **ุงูุชูุงุฑูุฑ**: ุชูุงุฑูุฑ ุงูุตูุงุฏูู ูุฌุจ ุฃู ุชุดูู ุงููุจูุบ ุงููุงูู

---

## ููุงุญุธุงุช ูููุฉ

โ๏ธ **ูุจู ุงูุชูููุฐ:**
- ุชุฃูุฏ ูู ุฃุฎุฐ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ููุถู ุงูุชูููุฐ ูู ููุช ูููู ุงูุงุณุชุฎุฏุงู

โ **ุจุนุฏ ุงูุชูููุฐ:**
- ูู ูุญุชุงุฌ ุงููุณุชุฎุฏููู ูุฃู ุฅุนุฏุงุฏุงุช ุฅุถุงููุฉ
- ุงูููุงุชูุฑ ุงูุฌุฏูุฏุฉ ุณุชุณุชูุฑ ูู ุทูุจ ุชุญุฏูุฏ ุงูุตูุฏูู
- ุงูุณูุฑูุจุช ุขูู ููููู ุชุดุบููู ุนุฏุฉ ูุฑุงุช (idempotent)

---

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ: "No module named 'sales'"
**ุงูุญู:** ุชุฃูุฏ ูู ุฃูู ูู ูุฌูุฏ ุงููุดุฑูุน ุงูุตุญูุญ ูุฃู Django settings ุตุญูุญ

### ุฎุทุฃ: "Permission denied"
**ุงูุญู:** ุชุฃูุฏ ูู ุตูุงุญูุงุช ุงูููู:
```bash
chmod +x fix_remote_cash_invoices.py
```

### ุฎุทุฃ: "No active users found"
**ุงูุญู:** ุชุฃูุฏ ูู ูุฌูุฏ ูุณุชุฎุฏู ูุดุท ูู ุงููุธุงู:
```bash
python manage.py createsuperuser
```

---

## ูุญุชูู ุงูุณูุฑูุจุช

ุงูุณูุฑูุจุช `fix_remote_cash_invoices.py` ููุฌูุฏ ูู ูุฌูุฏ ุงููุดุฑูุน ุงููุญูู.
ููููู ูุชุญู ููุณุฎ ูุญุชูุงู ูุฑูุนู ุนูู ุงูุฎุงุฏู ุจุฃู ุทุฑููุฉ ุชูุงุณุจู.

---

## ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ ุฃุซูุงุก ุงูุชูููุฐุ ููููู:
1. ุงูุชุญูู ูู ุณุฌูุงุช ุงูุฃุฎุทุงุก (logs)
2. ุงูุชุฃูุฏ ูู ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช
3. ุชุดุบูู ุงูุณูุฑูุจุช ูู ูุถุน Django Shell ููุชุญูู ุงูุฃูุถู
