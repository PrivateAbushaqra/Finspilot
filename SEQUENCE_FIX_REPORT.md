# ุฅุตูุงุญ ูุดููุฉ ุชุถุงุฑุจ ID ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ๐ ุงููุตู
ุชู ุญู ูุดููุฉ ุงูุฎุทุฃ: `duplicate key value violates unique constraint "customers_customersupplier_pkey" DETAIL: Key (id)=(1) already exists`

## ๐ ุงูุณุจุจ
ุนูุฏ ุงุณุชุนุงุฏุฉ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ูุง ูุชู ุชุญุฏูุซ ุชุณูุณูุงุช (sequences) ุงูู ID ุชููุงุฆูุงู ูู PostgreSQLุ ููุง ูุคุฏู ุฅูู ูุญุงููุฉ ุงููุธุงู ุงุณุชุฎุฏุงู ID ููุฌูุฏ ุจุงููุนู ุนูุฏ ุฅูุดุงุก ุณุฌู ุฌุฏูุฏ.

## โ ุงูุญู ุงููุทุจู

### 1. ุชุญุณูู ุฏุงูุฉ `reset_all_sequences()`
ุชู ุชุญุณูู ุงูุฏุงูุฉ ูู ููู `backup/views.py` ูุงุณุชุฎุฏุงู ุงุณุชุนูุงู PostgreSQL ูุญุณูู ูุญุตู ุนูู ุงูุนูุงูุฉ ุงูุตุญูุญุฉ ุจูู ุงูุฌุฏุงูู ูุงูุชุณูุณูุงุช:

```python
def reset_all_sequences():
    """ุฅุนุงุฏุฉ ุชุนููู ุฌููุน sequences ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุนุฏ ุงุณุชุนุงุฏุฉ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ"""
    # ูุณุชุฎุฏู ุงุณุชุนูุงู ูุญุณูู ููุญุตูู ุนูู ุฌููุน sequences ูุงูุฌุฏุงูู ุงููุฑุชุจุทุฉ
    # ูุชุญูู ูู ูููุฉ sequence ุงูุญุงููุฉ ูููุงุฑููุง ุจุฃุนูู ID ูู ุงูุฌุฏูู
    # ูุนูุฏ ุชุนููู sequence ููุท ุฅุฐุง ูุงู ุฃูู ูู max_id
```

**ุงูููู:** `c:\Accounting_soft\finspilot\backup\views.py` - ุงูุณุทุฑ 58

### 2. ุฅูุดุงุก ุฃูุฑ Django ูุฅุตูุงุญ ุงูุชุณูุณูุงุช
ุชู ุฅูุดุงุก ุฃูุฑ ุฅุฏุงุฑุฉ ุฌุฏูุฏ ูููู ุงุณุชุฎุฏุงูู ูู ุฃู ููุช ูุฅุตูุงุญ ุฌููุน ุงูุชุณูุณูุงุช:

```bash
# ุงูุงุณุชุฎุฏุงู ุงูุนุงุฏู
python manage.py fix_sequences

# ูุน ุนุฑุถ ุงูุชูุงุตูู
python manage.py fix_sequences --verbose
```

**ุงูููู:** `c:\Accounting_soft\finspilot\backup\management\commands\fix_sequences.py`

### 3. ุงูุงุณุชุฏุนุงุก ุงูุชููุงุฆู ูู ุนูููุฉ ุงูุงุณุชุนุงุฏุฉ
ุงูุฏุงูุฉ `reset_all_sequences()` ูุชู ุงุณุชุฏุนุงุคูุง ุชููุงุฆูุงู ุจุนุฏ ูู ุนูููุฉ ุงุณุชุนุงุฏุฉ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุงูุณุทุฑ 2149 ูู ููู `backup/views.py`.

## ๐ ูุชุงุฆุฌ ุงูุฅุตูุงุญ

### ุงูุชุณูุณูุงุช ุงูุชู ุชู ุฅุตูุงุญูุง:
- ุชู ุฅุตูุงุญ **30 sequence** ูุงูุช ุบูุฑ ูุญุฏุซุฉ
- ุฌููุน ุงูุชุณูุณูุงุช ุงูุขู ูุญุฏุซุฉ ุจุดูู ุตุญูุญ (78 sequence)

### ุฃูุซูุฉ ุนูู ุงูุชุณูุณูุงุช ุงููุตูุญุฉ:
- `customers_customersupplier`: ูู 1 ุฅูู 449
- `accounts_accounttransaction`: ูู 1 ุฅูู 157
- `sales_salesinvoice`: ูู 2 ุฅูู 658
- `products_product`: ูู 1 ุฅูู 715
- ูุบูุฑูุง...

## ๐งช ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุฅูุดุงุก ุนููู ุฌุฏูุฏ:
```python
# ุชู ุงูุงุฎุชุจุงุฑ ูุนูู ุจูุฌุงุญ
test_customer = CustomerSupplier.objects.create(
    name='ุนููู ุชุฌุฑูุจู',
    type='customer',
    city='ุงูุฑูุงุถ'
)
# ุงููุชูุฌุฉ: ID=449, sequence_number=10050 โ
```

### 2. ุงุฎุชุจุงุฑ ุฃูุฑ ุงูุฅุตูุงุญ:
```bash
python manage.py fix_sequences --verbose
# ุงููุชูุฌุฉ: โ ุชู ุฅุตูุงุญ 0 sequence ูู ุฃุตู 78
# (ุฌููุน ุงูุชุณูุณูุงุช ุตุญูุญุฉ)
```

## ๐ ููุงุญุธุงุช ูุงูุฉ

1. **ุนูููุฉ ุงูุงุณุชุนุงุฏุฉ:** ุงูุฏุงูุฉ ุชูุณุชุฏุนู ุชููุงุฆูุงู ุจุนุฏ ูู ุงุณุชุนุงุฏุฉุ ูุฐุง ูุง ุญุงุฌุฉ ูุชุดุบูู ุงูุฃูุฑ ูุฏููุงู ุจุนุฏ ุงูุงุณุชุนุงุฏุฉ.

2. **ุงูุงุณุชุฎุฏุงู ุงููุฏูู:** ุฅุฐุง ูุงุฌูุช ูุดููุฉ ุชุถุงุฑุจ ID ูู ุฃู ููุชุ ููููู ุชุดุบูู:
   ```bash
   python manage.py fix_sequences
   ```

3. **ุงูุฃุฏุงุก:** ุงูุฏุงูุฉ ูุญุณููุฉ ููุนูู ุจุณุฑุนุฉ ุนูู ููุงุนุฏ ุจูุงูุงุช ูุจูุฑุฉ.

4. **ุงูุฃูุงู:** ุงูุฏุงูุฉ ูุง ุชุคุซุฑ ุนูู ุงูุจูุงูุงุช ุงูููุฌูุฏุฉุ ููุท ุชุญุฏุซ ุงูุชุณูุณูุงุช.

## ๐ ุงูุชุฑุฌูุฉ ูุณุฌู ุงูุฃูุดุทุฉ

- โ ุฌููุน ุงูุฑุณุงุฆู ูุชุฑุฌูุฉ ุฅูู ุงูุนุฑุจูุฉ
- โ ุนูููุฉ ุฅุตูุงุญ ุงูุชุณูุณูุงุช ูุชู ุชุณุฌูููุง ูู ุงูุณุฌูุงุช (logs)
- โ ุฃู ุฎุทุฃ ูุชู ุชุณุฌููู ุจุดูู ููุตู

## ๐ ุงูุชุงุฑูุฎ
- **ุชุงุฑูุฎ ุงูุฅุตูุงุญ:** 6 ุฃูุชูุจุฑ 2025
- **ุงูุฅุตุฏุงุฑ:** FinsPilot v1.0

## ๐ค ุงููุณุชุฎุฏู
- **ุงุณู ุงููุณุชุฎุฏู:** super
- **ุงูุตูุงุญูุฉ:** superadmin

---

**ููุงุญุธุฉ:** ูุฐุง ุงูุฅุตูุงุญ ุฌุฒุก ูู ูุธุงู ุงููุณุฎ ุงูุงุญุชูุงุทู ูุงูุงุณุชุนุงุฏุฉุ ููุถูู ุนุฏู ุญุฏูุซ ุชุถุงุฑุจ ูู IDs ุจุนุฏ ุงุณุชุนุงุฏุฉ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ.
