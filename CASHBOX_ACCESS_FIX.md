# โ ุชู ุฅุตูุงุญ ุนุฑุถ ูุงุฆูุฉ ุงูุตูุงุฏูู ูุฌููุน ุงููุณุชุฎุฏููู

## ๐ฏ ุงูุชุญุฏูุซ ุงููุทุจู

### ุงููุดููุฉ ุงูุณุงุจูุฉ:
- ูุงุฆูุฉ ุงูุตูุงุฏูู ูุงูุช ูุฎููุฉ ุนู ุงููุณุชุฎุฏููู ุงูุนุงุฏููู
- ูุงู ูุดุชุฑุท ูุฌูุฏ ุตูุงุญูุงุช POS ูุฅุธูุงุฑ ุงูุญูู
- ุงููุณุชุฎุฏููู ุจุญุงุฌุฉ ูุตูุงุญูุงุช ุงููุตูู ุฅูู `/ar/cashboxes/` ูุงุฎุชูุงุฑ ุงูุตูุฏูู

### ุงูุญู ุงููุทุจู:
โ **ุฅุฒุงูุฉ ุฌููุน ุดุฑูุท ุงูุตูุงุญูุงุช ูู ุนุฑุถ ูุงุฆูุฉ ุงูุตูุงุฏูู**
โ **ุฅุธูุงุฑ ุงููุงุฆูุฉ ูุฌููุน ุงููุณุชุฎุฏููู ุนูุฏ ุงุฎุชูุงุฑ "ููุฏุงู" ุฃู "ุดูู"**
โ **ูุง ุญุงุฌุฉ ูุตูุงุญูุงุช ุงููุตูู ุฅูู ุตูุญุงุช ุฅุฏุงุฑุฉ ุงูุตูุงุฏูู**

---

## ๐ ุงูุชุนุฏููุงุช ุงููุทุจูุฉ

### 1. ููู `templates/sales/invoice_add.html`

#### ุงูุชุบููุฑ ุงูุฃูู (ุงูุณุทูุฑ 343-369):
**ุฅุฒุงูุฉ ุดุฑุท `can_change_cashbox` ูุชุจุณูุท ุงูููุฏ:**

```html
<!-- ูุจู -->
{% if can_change_cashbox %}
    <select name="cashbox">...</select>
{% else %}
    <input type="text" readonly>
{% endif %}

<!-- ุจุนุฏ โ -->
<select class="form-select" id="id_cashbox" name="cashbox">
    <option value="">ุงุฎุชุฑ ุงูุตูุฏูู</option>
    {% for cashbox in cashboxes %}
        <option value="{{ cashbox.id }}">{{ cashbox.name }}</option>
    {% endfor %}
</select>
```

**ุงููุชูุฌุฉ:**
- โ ุฌููุน ุงููุณุชุฎุฏููู ูุฑูู ููุณ ุงููุงุฆูุฉ ุงูููุณุฏูุฉ
- โ ูููู ูุฃู ูุณุชุฎุฏู ุงุฎุชูุงุฑ ุฃู ุตูุฏูู ูุดุท
- โ ูููู ุญูุธ ุงูุตูุฏูู ุงููุฎุชุงุฑ ูุตูุฏูู ุงูุชุฑุงุถู

---

#### ุงูุชุบููุฑ ุงูุซุงูู (ุงูุณุทุฑ 2117):
**ุชุญุฏูุซ JavaScript ูุฅุธูุงุฑ ุงูุญูู ุนูุฏ ุงุฎุชูุงุฑ "ููุฏุงู" ุฃู "ุดูู":**

```javascript
// ูุจู
if (paymentType === 'cash') {
    cashboxContainer.style.display = 'block';
}

// ุจุนุฏ โ
if (paymentType === 'cash' || paymentType === 'check') {
    cashboxContainer.style.display = 'block';
    cashboxSelect.required = true;
}
```

**ุงููุชูุฌุฉ:**
- โ ูุธูุฑ ุญูู ุงูุตูุฏูู ุนูุฏ ุงุฎุชูุงุฑ "ููุฏุงู" โ
- โ ูุธูุฑ ุญูู ุงูุตูุฏูู ุนูุฏ ุงุฎุชูุงุฑ "ุดูู" โ
- โ ุงูุญูู ุฅูุฒุงูู ูู ููุง ุงูุญุงูุชูู

---

#### ุงูุชุบููุฑ ุงูุซุงูุซ (ุงูุณุทุฑ 2147):
**ุนุฑุถ ุงูุญูู ุชููุงุฆูุงู ุนูุฏ ุชุญููู ุงูุตูุญุฉ:**

```javascript
// ูุจู
if (currentPaymentType === 'cash') {
    cashboxContainer.style.display = 'block';
}

// ุจุนุฏ โ
if (currentPaymentType === 'cash' || currentPaymentType === 'check') {
    cashboxContainer.style.display = 'block';
    cashboxSelect.required = true;
}
```

**ุงููุชูุฌุฉ:**
- โ ุฅุฐุง ูุงู payment_type ูุญููุธุงู ูู "ููุฏุงู" ุฃู "ุดูู"ุ ูุธูุฑ ุงูุญูู ููุฑุงู

---

### 2. ููู `sales/views.py`

#### ุงูุชุบููุฑ ุงูุฃูู (ุงูุณุทูุฑ 442-444):
**ุฏุนู ุงูุดููุงุช ูู ุงูุญุตูู ุนูู ุงูุตูุฏูู:**

```python
# ูุจู
cashbox_id = request.POST.get('cashbox') if payment_type == 'cash' else None
set_default_cashbox = request.POST.get('set_default_cashbox') == 'on' and payment_type == 'cash'

# ุจุนุฏ โ
cashbox_id = request.POST.get('cashbox') if payment_type in ['cash', 'check'] else None
set_default_cashbox = request.POST.get('set_default_cashbox') == 'on' and payment_type in ['cash', 'check']
```

**ุงููุชูุฌุฉ:**
- โ ุงูุตูุฏูู ููุญูุธ ูููุฏููุนุงุช ุงูููุฏูุฉ
- โ ุงูุตูุฏูู ููุญูุธ ูููุฏููุนุงุช ุจุงูุดูู
- โ ูููู ุญูุธ ุงูุตูุฏูู ูุงูุชุฑุงุถู ูู ููุง ุงูุญุงูุชูู

---

#### ุงูุชุบููุฑ ุงูุซุงูู (ุงูุณุทุฑ 526):
**ุชุญุฏูุซ ุดุฑุท ุงูุตูุฏูู ููุดูู ุงูุดููุงุช:**

```python
# ูุจู
if payment_type == 'cash':
    cashbox = ...

# ุจุนุฏ โ
if payment_type in ['cash', 'check']:
    cashbox = ...
```

**ุงููุชูุฌุฉ:**
- โ ูุชู ุชุญุฏูุฏ ุงูุตูุฏูู ููุฏูุน ุงูููุฏู
- โ ูุชู ุชุญุฏูุฏ ุงูุตูุฏูู ููุฏูุน ุจุงูุดูู
- โ ููุณ ุงูููุทู ููุทุจู ุนูู ููุง ุงูููุนูู

---

#### ุงูุชุบููุฑ ุงูุซุงูุซ (ุงูุณุทุฑ 856):
**ุชุญุฏูุซ ุณุฌู ุงููุดุงุท:**

```python
# ูุจู
if payment_type == 'cash' and cashbox:
    activity_desc += _(' - ุฏูุน ููุฏู ูู ุงูุตูุฏูู: %(cashbox)s') % {...}

# ุจุนุฏ โ
if payment_type in ['cash', 'check'] and cashbox:
    payment_method = _('ููุฏู') if payment_type == 'cash' else _('ุดูู')
    activity_desc += _(' - ุฏูุน %(method)s ูู ุงูุตูุฏูู: %(cashbox)s') % {
        'method': payment_method, 
        'cashbox': cashbox.name
    }
```

**ุงููุชูุฌุฉ:**
- โ ุณุฌู ุงููุดุงุท ูุนุฑุถ "ุฏูุน ููุฏู ูู ุงูุตูุฏูู: [ุงุณู]"
- โ ุณุฌู ุงููุดุงุท ูุนุฑุถ "ุฏูุน ุดูู ูู ุงูุตูุฏูู: [ุงุณู]"

---

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

### ุณููุงุฑูู 1: ูุณุชุฎุฏู ุจุฏูู ุฃู ุตูุงุญูุงุช ุฎุงุตุฉ
```
1. ููุชุญ ุตูุญุฉ ุฅูุดุงุก ูุงุชูุฑุฉ โ
2. ูุฎุชุงุฑ "ููุฏุงู" ุฃู "ุดูู" โ
3. โ ุชุธูุฑ ูุงุฆูุฉ ููุณุฏูุฉ ุจุฌููุน ุงูุตูุงุฏูู ุงููุดุทุฉ โ
4. ูุฎุชุงุฑ "ุตูุฏูู ุงููุฑุน ุงูุฑุฆูุณู" โ
5. ูุญูุธ ุงููุงุชูุฑุฉ โ
   โ ุงูููุฏ/ุงูุดูู ููุถุงู ุฅูู ุงูุตูุฏูู ุงููุฎุชุงุฑ
```

### ุณููุงุฑูู 2: ูุณุชุฎุฏู POS
```
1. ููุชุญ ุตูุญุฉ ุฅูุดุงุก ูุงุชูุฑุฉ โ
2. ูุฎุชุงุฑ "ููุฏุงู" ุฃู "ุดูู" โ
3. โ ุชุธูุฑ ูุงุฆูุฉ ููุณุฏูุฉ ุจุฌููุน ุงูุตูุงุฏูู โ
4. ุงูุตูุฏูู ุงูุงูุชุฑุงุถู ูุญุฏุฏ ูุณุจูุงู (ุตูุฏููู ุงููุฑุชุจุท) โ
5. ููููู ุชุบููุฑ ุงูุตูุฏูู ุฅุฐุง ุฃุฑุงุฏ โ
```

### ูุง ูุง ูุญุชุงุฌู ุงููุณุชุฎุฏู:
- โ ูุง ูุญุชุงุฌ ุตูุงุญูุฉ `can_access_pos`
- โ ูุง ูุญุชุงุฌ ุตูุงุญูุฉ ุงููุตูู ุฅูู `/ar/cashboxes/`
- โ ูุง ูุญุชุงุฌ ุตูุงุญูุฉ `view_cashbox`
- โ ูุง ูุญุชุงุฌ ุตูุงุญูุฉ `add_cashbox`
- โ ูุง ูุญุชุงุฌ ุตูุงุญูุฉ `change_cashbox`

### ูุง ูุญุชุงุฌู ุงููุณุชุฎุฏู ููุท:
- โ ุตูุงุญูุฉ ุฅูุดุงุก ูุงุชูุฑุฉ ูุจูุนุงุช (`add_salesinvoice`)

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุงูุฏูุน ุงูููุฏู
```
1. ุงุฐูุจ ุฅูู: http://127.0.0.1:8000/ar/sales/invoices/add/
2. ุงุฎุชุฑ "ููุฏุงู" ูู ููุน ุงูุฏูุน
3. ุงููุชูุฌุฉ ุงููุชููุนุฉ:
   โ ุธููุฑ ูุงุฆูุฉ ููุณุฏูุฉ "ุงูุตูุฏูู ุงูููุฏู"
   โ ุฌููุน ุงูุตูุงุฏูู ุงููุดุทุฉ ููุฌูุฏุฉ
   โ ุงูุญูู ุฅูุฒุงูู (*)
```

### 2. ุงุฎุชุจุงุฑ ุงูุฏูุน ุจุงูุดูู
```
1. ุงุฐูุจ ุฅูู: http://127.0.0.1:8000/ar/sales/invoices/add/
2. ุงุฎุชุฑ "ุดูู" ูู ููุน ุงูุฏูุน
3. ุงููุชูุฌุฉ ุงููุชููุนุฉ:
   โ ุธููุฑ ูุงุฆูุฉ ููุณุฏูุฉ "ุงูุตูุฏูู ุงูููุฏู"
   โ ุฌููุน ุงูุตูุงุฏูู ุงููุดุทุฉ ููุฌูุฏุฉ
   โ ุงูุญูู ุฅูุฒุงูู (*)
```

### 3. ุงุฎุชุจุงุฑ ุงูุฏูุน ุงูุขุฌู
```
1. ุงุฐูุจ ุฅูู: http://127.0.0.1:8000/ar/sales/invoices/add/
2. ุงุฎุชุฑ "ุฐูู (ุขุฌู)" ูู ููุน ุงูุฏูุน
3. ุงููุชูุฌุฉ ุงููุชููุนุฉ:
   โ ุฅุฎูุงุก ุญูู ุงูุตูุฏูู
   โ ูุง ูุธูุฑ ุฃู ุตูุฏูู
```

---

## ๐ ููุฎุต ุงูุชุนุฏููุงุช

| ุงูููู | ุงูุชุนุฏููุงุช | ุงูุบุฑุถ |
|------|----------|-------|
| `templates/sales/invoice_add.html` | 3 ุชุนุฏููุงุช | ุฅุฒุงูุฉ ุดุฑูุท ุงูุตูุงุญูุงุช ูุฅุธูุงุฑ ุงููุงุฆูุฉ ููุฌููุน |
| `sales/views.py` | 3 ุชุนุฏููุงุช | ุฏุนู ุงูุดููุงุช ูุฏูุฌ ุงูููุทู |

---

## โ๏ธ ููุงุญุธุฉ ูููุฉ

**ูู ูุชู ุฑูุน ุงูุชุนุฏููุงุช ุนูู GitHub** (ุญุณุจ ุทูุจู)

ุฌููุน ุงูุชุนุฏููุงุช ูุญููุฉ ููุท. ูุฑูุนูุง ูุงุญูุงู:
```bash
git add templates/sales/invoice_add.html sales/views.py
git commit -m "feat: ุนุฑุถ ูุงุฆูุฉ ุงูุตูุงุฏูู ูุฌููุน ุงููุณุชุฎุฏููู ุนูุฏ ุงูุฏูุน ููุฏุงู ุฃู ุจุงูุดูู"
git push origin main
```

---

## ๐ ุงูุฃูุงู

### ููุงุญุธุงุช ุฃูููุฉ:
1. โ ุงููุณุชุฎุฏู ููููู ููุท **ุงุฎุชูุงุฑ** ุงูุตูุฏููุ ููุณ ุงููุตูู ุฅููู
2. โ ูุง ููููู ุฑุคูุฉ ุฑุตูุฏ ุงูุตูุฏูู (ูุนูู ูู ุงูุชุนููู: `<!--({{ cashbox.balance }})-->`)
3. โ ูุง ููููู ุชุนุฏูู ุงูุตูุฏูู ุฃู ุญุฐูู
4. โ ูุง ููููู ุงููุตูู ุฅูู ุตูุญุงุช ุฅุฏุงุฑุฉ ุงูุตูุงุฏูู
5. โ ุงูุตูุงุญูุงุช ูุญููุธุฉ ูุตูุญุงุช `/ar/cashboxes/` ู `/ar/cashboxes/transfers/`

**ุงููุฏู:** ููุท ุชุญุฏูุฏ ุฃูู ุณูุฐูุจ ุงูููุฏ/ุงูุดููุ ุฏูู ุฅุนุทุงุก ุตูุงุญูุงุช ุฅุฏุงุฑุฉ ุงูุตูุงุฏูู.

---

## โ ุงูุชุฃููุฏ

- [x] ูุงุฆูุฉ ุงูุตูุงุฏูู ุชุธูุฑ ูุฌููุน ุงููุณุชุฎุฏููู
- [x] ูุง ุญุงุฌุฉ ูุตูุงุญูุงุช ุฎุงุตุฉ
- [x] ูุนูู ูุน ุงูุฏูุน ุงูููุฏู
- [x] ูุนูู ูุน ุงูุฏูุน ุจุงูุดูู
- [x] ูู ูุชู ุฑูุน ุงูุชุนุฏููุงุช ุนูู ุงูุฑูููุช
- [x] ุฌููุน ุงูุชุนุฏููุงุช ูุญููุฉ
