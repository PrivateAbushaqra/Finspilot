# ✅ تم إصلاح مشكلة عرض الصناديق النقدية

## 🐛 المشكلة
عند إنشاء فاتورة مبيعات نقدية، المستخدمين العاديين (بدون صلاحية POS) **لا يرون قائمة الصناديق** لاختيار الصندوق الذي سيستقبل النقد.

## 🔧 السبب
الكود كان يخفي حقل الصندوق بالكامل إذا كان `can_change_cashbox = False`، وكان المنطق معكوساً.

## ✅ الحل
تم تعديل 2 ملف:

### 1. `templates/sales/invoice_add.html`
- ✅ حذف الشرط الذي يخفي الحقل بالكامل
- ✅ إضافة قائمة منسدلة للمستخدمين العاديين
- ✅ إضافة حقل readonly لمستخدمي POS
- ✅ إظهار الحقل تلقائياً عند اختيار "نقداً"

### 2. `sales/views.py`
- ✅ تحديد الصندوق الافتراضي حسب نوع المستخدم
- ✅ مستخدم POS → الصندوق المرتبط به (`responsible_user`)
- ✅ مستخدم عادي → الصندوق الافتراضي المحفوظ

## 📊 النتيجة

### مستخدم عادي (بدون POS):
```
1. يختار "نقداً" ← تظهر قائمة منسدلة
2. يختار الصندوق من القائمة
3. يمكنه حفظه كصندوق افتراضي
```

### مستخدم POS (كاشير):
```
1. يختار "نقداً" ← يظهر صندوقه المعين فقط (readonly)
2. لا يمكن التعديل
3. القيمة ترسل تلقائياً
```

## 🧪 كيفية الاختبار

1. سجل دخول بمستخدم عادي (ليس لديه صلاحية `can_access_pos`)
2. اذهب إلى: http://127.0.0.1:8000/ar/sales/invoices/add/
3. اختر "نقداً" من نوع الدفع
4. **النتيجة المتوقعة:** ظهور قائمة منسدلة بجميع الصناديق النشطة ✅

## 📝 ملاحظات
- ⚠️ لم يتم رفع التعديلات على GitHub (حسب طلبك)
- ✅ جميع التعديلات محلية فقط
- 📄 الملفات المعدلة: 2
  - `templates/sales/invoice_add.html`
  - `sales/views.py`
