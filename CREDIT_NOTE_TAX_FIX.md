# ๐ง ุฅุตูุงุญ ุฎุทุฃ tax_amount ูู ุฅุดุนุงุฑุงุช ุงูุฏุงุฆู

## ๐ ุงููุดููุฉ

ุนูุฏ ุงุณุชุฑุฌุงุน ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉุ ูุธูุฑ ุงูุฎุทุฃ:
```
ุฎุทุฃ ูู ุฅูุดุงุก ููุฏ ุฅุดุนุงุฑ ุงูุฏุงุฆู CRD000010: 'SalesCreditNote' object has no attribute 'tax_amount'
```

---

## ๐ ุงูุณุจุจ

**ุงูููุฏูู `SalesCreditNote` ูุง ูุญุชูู ุนูู ุญูู `tax_amount`!**

```python
# sales/models.py - class SalesCreditNote
class SalesCreditNote(models.Model):
    note_number = models.CharField(...)
    date = models.DateField(...)
    customer = models.ForeignKey(...)
    subtotal = models.DecimalField(...)        # โ ููุฌูุฏ
    total_amount = models.DecimalField(...)    # โ ููุฌูุฏ
    # โ tax_amount ุบูุฑ ููุฌูุฏ!
```

ููู ุงูุณูุฌูุงู ูู `journal/services.py` ูุญุงูู ุงุณุชุฎุฏุงูู:
```python
if credit_note.tax_amount > 0:  # โ ุฎุทุฃ!
```

---

## โ ุงูุญู ุงูููุทุจูู

ุชู ุชุนุฏูู `journal/services.py` (ุงูุณุทุฑ 968):

### ูุจู:
```python
if credit_note.tax_amount > 0:
    # ุฅูุดุงุก ุณุทุฑ ุงูุถุฑูุจุฉ...
```

### ุจุนุฏ:
```python
if hasattr(credit_note, 'tax_amount') and credit_note.tax_amount > 0:
    # ุฅูุดุงุก ุณุทุฑ ุงูุถุฑูุจุฉ...
```

ุงูุขู ุงูุณูุฌูุงู ูุชุญูู ูู **ูุฌูุฏ ุงูุญูู ุฃููุงู** ูุจู ุงุณุชุฎุฏุงูู!

---

## ๐ ุงููุชูุฌุฉ

โ **ูู ูุธูุฑ ุงูุฎุทุฃ ุจุนุฏ ุงูุขู** ุนูุฏ ุงุณุชุฑุฌุงุน ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ  
โ ุงููููุฏ ุงููุญุงุณุจูุฉ ุชููุดุฃ ุจุฏูู ูุดุงูู  
โ ุงููุธุงู ูุนูู ูุน ุฃู ุจุฏูู ุญูู `tax_amount`

---

## ๐ฎ ุงูุชุญุณูู ุงููุณุชูุจูู (ุงุฎุชูุงุฑู)

ุฅุฐุง ุฃุฑุฏุช ุฏุนู ุงูุถุฑูุจุฉ ูู ุฅุดุนุงุฑุงุช ุงูุฏุงุฆูุ ุฃุถู ุงูุญูู ููููุฏูู:

```python
# sales/models.py - class SalesCreditNote
class SalesCreditNote(models.Model):
    # ... ุงูุญููู ุงูููุฌูุฏุฉ
    
    # โจ ุฅุถุงูุฉ ุญูู ุงูุถุฑูุจุฉ
    tax_amount = models.DecimalField(
        _('ูุจูุบ ุงูุถุฑูุจุฉ'), 
        max_digits=15, 
        decimal_places=3, 
        default=0
    )
```

ุซู ุนูู migration:
```bash
python manage.py makemigrations sales
python manage.py migrate
```

---

## ๐ ุงููููุงุช ุงูููุนุฏููุฉ

- โ `journal/services.py` (ุงูุณุทุฑ 968)

---

## ๐งช ุงูุงุฎุชุจุงุฑ

ูุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ:
```bash
# ุงุณุชุฑุฌุงุน ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุชุญุชูู ุนูู ุฅุดุนุงุฑุงุช ุฏุงุฆู
python manage.py restore_backup backup_file.json

# ูุฌุจ ุฃู ูุง ุชุธูุฑ ุฑุณุงุฆู ุงูุฎุทุฃ:
# โ ูุง ููุฌุฏ: 'SalesCreditNote' object has no attribute 'tax_amount'
```

---

## ๐ฏ ุงูุฎูุงุตุฉ

| ุงููุดููุฉ | ุงูุญู |
|---------|------|
| โ `tax_amount` ุบูุฑ ููุฌูุฏ ูู ุงูููุฏูู | โ ุงุณุชุฎุฏุงู `hasattr()` ููุชุญูู ุฃููุงู |
| โ ุฎุทุฃ ุนูุฏ ุงุณุชุฑุฌุงุน ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ | โ ุงูุณูุฌูุงู ูุนูู ุจุฏูู ูุดุงูู |
| โ๏ธ  ุงูุถุฑูุจุฉ ุบูุฑ ูุฏุนููุฉ ุญุงููุงู | ๐ฎ ูููู ุฅุถุงูุฉ ุงูุญูู ูุงุญูุงู |

---

**ุงูุชุงุฑูุฎ**: 5 ุฃูุชูุจุฑ 2025  
**ุงูุญุงูุฉ**: โ ุชู ุงูุฅุตูุงุญ  
**ุงูุฃููููุฉ**: ๐ด ุนุงููุฉ (ูุคุซุฑ ุนูู ุงุณุชุฑุฌุงุน ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ)
